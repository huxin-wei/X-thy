(this["webpackJsonpmusic-teacher-react"]=this["webpackJsonpmusic-teacher-react"]||[]).push([[0],{45:function(e,t,n){},93:function(e,t,n){"use strict";n.r(t);var c=n(2),s=n.n(c),a=n(30),r=n.n(a),i=n(3),l=(n(45),n(11)),o=n(6),j=n(21),d=n(33),b=n(32),u=n(34),h=n(15),m=n.n(h),O=Object(c.createContext)({}),p="http://localhost:3001",f=n(1);var x=function(){var e=Object(c.useContext)(O).setUser,t=25;return Object(f.jsxs)("div",{className:"sidebar-wrapper",children:[Object(f.jsx)("div",{className:"sidebar-upper-wrapper",children:Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"calendar",children:Object(f.jsxs)(l.b,{activeClassName:"sidebar-link--active",className:"sidebar-link",to:"/calendar",children:[Object(f.jsx)(b.a,{size:t}),Object(f.jsx)("p",{children:"Calendar"})]})}),Object(f.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"manage guitar lessons",children:Object(f.jsxs)(l.b,{activeClassName:"sidebar-link--active",className:"sidebar-link",to:"/lesson",children:[Object(f.jsx)(j.b,{size:t}),Object(f.jsx)("p",{children:"Lesson"})]})}),Object(f.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"manage my availability",children:Object(f.jsxs)(l.b,{activeClassName:"sidebar-link--active",className:"sidebar-link",to:"/availability",children:[Object(f.jsx)(j.c,{size:t}),Object(f.jsx)("p",{children:"Availability"})]})}),Object(f.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"book an appointment",children:Object(f.jsxs)(l.b,{activeClassName:"sidebar-link--active",className:"sidebar-link",to:"/booking",children:[Object(f.jsx)(j.a,{size:t}),Object(f.jsx)("p",{children:"Book appointment"})]})}),Object(f.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"Account",children:Object(f.jsxs)(l.b,{activeClassName:"sidebar-link--active",className:"sidebar-link",to:"/account",children:[Object(f.jsx)(d.a,{size:t}),Object(f.jsx)("p",{children:"Account"})]})})]})}),Object(f.jsx)("div",{className:"sidebar-bottom-wrapper",children:Object(f.jsx)("ul",{children:Object(f.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"log out",children:Object(f.jsxs)(l.b,{className:"sidebar-link",to:"/",onClick:function(){fetch("".concat(p,"/api/auth/logout"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(t){if(!t.success)throw new Error(t.message);m.a.remove("loggedIn"),e(null)})).catch((function(e){console.log(e.message),alert("Something went wrong. Cannot logout properly.")}))},children:[Object(f.jsx)(u.a,{size:t}),Object(f.jsx)("p",{children:"Logout"})]})})})})]})};var g=function(e){var t=Object(c.useState)(""),n=Object(i.a)(t,2),s=n[0],a=n[1],r=Object(c.useState)(""),l=Object(i.a)(r,2),o=l[0],j=l[1],d=Object(c.useState)(""),b=Object(i.a)(d,2),u=b[0],h=b[1],m=Object(c.useState)(""),O=Object(i.a)(m,2),x=O[0],g=O[1],v=Object(c.useState)(!1),y=Object(i.a)(v,2),N=y[0],w=y[1],S=Object(c.useState)(""),C=Object(i.a)(S,2),A=C[0],k=C[1],M=Object(c.useRef)(!0);return Object(c.useEffect)((function(){return function(){M.current=!1}}),[]),console.log("Create lesson form re render"),Object(f.jsx)("div",{children:Object(f.jsx)("div",{className:"mt-3 mb-3",children:Object(f.jsxs)("form",{onSubmit:function(t){if(t.preventDefault(),!M.current)return null;w(!0),k("");var n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({lesson:s,description:o,price30m:u,price60m:x}),credentials:"include"};fetch("".concat(p,"/api/lesson/add"),n).then((function(e){return e.json()})).then((function(t){if(!M.current)return null;if(!t.success)throw new Error(t.message);e.handleClose(),e.signalAddSuccess()})).catch((function(e){if(!M.current)return null;console.log(e),k(e.message),w(!1)}))},className:"form-default-box mw-600",children:[Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsxs)("label",{htmlFor:"lessonName",className:"form-label",children:[Object(f.jsx)("b",{children:"Lesson name"})," (",70-s.length," chars left)"]}),Object(f.jsx)("input",{onChange:function(e){var t=e.target.value;t.length<=70?a(e.target.value):e.target.value=t},value:s,type:"text",className:"form-control",id:"lessonName"})]}),Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsxs)("label",{htmlFor:"description",className:"form-label",children:[Object(f.jsx)("b",{children:"Description"})," (",500-o.length," chars left)"]}),Object(f.jsx)("textarea",{onChange:function(e){e.target.style.height="",e.target.style.height=Math.min(e.target.scrollHeight,300)+"px";var t=e.target.value;t.length<=500&&j(t),t.length>500&&(e.target.value=o)},className:"form-control",id:"description",rows:5,maxLength:300,wrap:"soft"})]}),Object(f.jsx)("div",{className:"mb-3",children:Object(f.jsx)("b",{children:"Price rates"})}),Object(f.jsxs)("div",{className:"row g-2 mb-2",children:[Object(f.jsx)("div",{className:"col-auto",children:Object(f.jsx)("label",{htmlFor:"price-30m",className:"form-label",children:"30 minutes"})}),Object(f.jsx)("div",{className:"col-3",children:Object(f.jsx)("input",{type:"text",onChange:function(e){var t=e.target.value;/^\d+\.{0,1}\d{0,2}$/.test(t)||""===t?h(t):e.target.value=""},value:u,maxLength:"10",className:"form-control",id:"price-30m"})}),Object(f.jsx)("div",{className:"col-auto",children:"$"})]}),Object(f.jsxs)("div",{className:"row g-2 mb-2 ",children:[Object(f.jsx)("div",{className:"col-auto ",children:Object(f.jsx)("label",{htmlFor:"price-60m",className:"form-label align-middle",children:"60 minutes"})}),Object(f.jsx)("div",{className:"col-3",children:Object(f.jsx)("input",{type:"text",onChange:function(e){var t=e.target.value;/^\d+\.{0,1}\d{0,2}$/.test(t)||""===t?g(t):e.target.value=""},value:x,maxLength:"10",className:"form-control",id:"price-60m"})}),Object(f.jsx)("div",{className:"col-auto",children:"$"})]}),A&&Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:A}),Object(f.jsxs)("div",{style:{width:"100%",height:30,margin:"25px auto 10px auto"},children:[Object(f.jsx)("button",{type:"button",className:"btn btn-danger d-inline-block float-start",onClick:function(){return e.handleClose()},children:"Cancel"}),N?Object(f.jsxs)("button",{className:"btn btn-primary float-end",type:"button",disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:"Loading..."})]}):Object(f.jsx)("button",{type:"submit",className:"btn btn-primary d-inline-block float-end",children:"Add"})]})]})})})},v=n(19);var y=function(e){var t=e.lessonId,n=e.lessonName,s=e.description,a=e.price30m,r=e.price60m,l=e.removeLesson,o=Object(c.useState)(""),j=Object(i.a)(o,2),d=j[0],b=j[1],u=Object(c.useState)(!1),h=Object(i.a)(u,2),m=h[0],O=h[1],x=Object(c.useRef)(!0);return Object(c.useEffect)((function(){return function(){x.current=!1}}),[]),Object(f.jsx)("div",{className:"mb-2 pd-4",children:Object(f.jsxs)("div",{className:"default-wrapper mw-600",children:[Object(f.jsx)("h1",{className:"web-main-color",children:n}),Object(f.jsxs)("div",{className:"ms-3 mb-2",children:[Object(f.jsx)("p",{className:"text-secondary",children:s}),Object(f.jsx)("p",{className:"mb-1 text-secondary",children:Object(f.jsx)("b",{children:"Fee rates"})}),Object(f.jsxs)("p",{className:"mb-1 text-secondary",children:["30 minutes: ",Object(f.jsxs)("b",{children:["$",a]})]}),Object(f.jsxs)("p",{className:"mb-1 text-secondary",children:["60 minutes: ",Object(f.jsxs)("b",{children:["$",r]})]})]}),d&&Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:d}),Object(f.jsx)("div",{style:{height:30},children:m?Object(f.jsxs)("button",{className:"btn btn-danger py-1 float-end",type:"button",disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:"Deleting..."})]}):Object(f.jsxs)("button",{onClick:function(){O(!0),b("");fetch("".concat(p,"/api/lesson/delete/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(!e.success)throw new Error(e.message);if(!x.current)return null;O(!1),b(""),l(t)})).catch((function(e){if(!x.current)return null;O(!1),b(e.message)}))},type:"button",title:"delete",className:"btn btn-danger py-1 float-end",children:[Object(f.jsx)(v.a,{size:20}),Object(f.jsx)("span",{className:"align-middle button-text",style:{fontSize:12},children:"DELETE"})]})})]})})};var N=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(!1),r=Object(i.a)(a,2),l=r[0],o=r[1],j=Object(c.useState)(!1),d=Object(i.a)(j,2),b=d[0],u=d[1],h=Object(c.useState)(0),m=Object(i.a)(h,2),O=m[0],x=m[1],v=Object(c.useState)(!1),N=Object(i.a)(v,2),w=N[0],S=N[1],C=Object(c.useState)(""),A=Object(i.a)(C,2),k=A[0],M=A[1],E=Object(c.useRef)(!0),D=function(e){s(n.filter((function(t){return t.lesson_id!=e})))};return Object(c.useEffect)((function(){return function(){E.current=!1}}),[]),Object(c.useEffect)((function(){if(!E.current)return null;S(!0),M("");fetch("".concat(p,"/api/lesson/active"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(!e.success)throw new Error(e.message);if(!e.lessons.length)throw new Error("There is no lesson. Please consider creating one.");if(!E.current)return null;s(e.lessons),S(!1),M("")})).catch((function(e){if(!E.current)return null;console.log(e.message),S(!1),M(e.message)}))}),[O]),Object(f.jsxs)("div",{className:"pt-3",children:[b&&Object(f.jsx)("div",{className:"alert alert-success",role:"alert",children:"Successfully added."}),l?Object(f.jsx)(g,{handleClose:function(){return o(!1)},signalAddSuccess:function(){u(!0),x(O+1),setTimeout((function(){u(!1)}),2e3)}}):Object(f.jsx)("div",{style:{textAlign:"center"},children:Object(f.jsx)("button",{className:"btn btn-primary",onClick:function(){return o(!0)},children:"Add Lesson"})}),Object(f.jsxs)("div",{className:"pt-3",style:{textAlign:"center"},children:[w?Object(f.jsx)("div",{className:"text-center",children:Object(f.jsx)("div",{className:"spinner-border",role:"status",style:{color:"orange"}})}):k&&Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:k}),n.map((function(e){return Object(f.jsx)(y,{removeLesson:D,lessonId:e.lesson_id,lessonName:e.lesson_name,description:e.description,price30m:e.price_30m,price60m:e.price_60m},e.lesson_id)}))]})]})},w=n(13),S=n(16),C=[{value:0,month:"JAN"},{value:1,month:"FEB"},{value:2,month:"MAR"},{value:3,month:"APR"},{value:4,month:"MAY"},{value:5,month:"JUN"},{value:6,month:"JUL"},{value:7,month:"AUG"},{value:8,month:"SEP"},{value:9,month:"OCT"},{value:10,month:"NOV"},{value:11,month:"DEC"}],A=["Sun","Mon","Tu","Wed","Th","Fri","Sat"];var k=function(e){var t=Object(c.useState)(e.date),n=Object(i.a)(t,2),s=n[0],a=n[1],r=Object(c.useState)(e.month),l=Object(i.a)(r,2),o=l[0],j=l[1],d=Object(c.useState)(e.year),b=Object(i.a)(d,2),u=b[0],h=b[1],m=Object(c.useState)(e.month),O=Object(i.a)(m,2),p=O[0],x=O[1],g=Object(c.useState)(e.year),v=Object(i.a)(g,2),y=v[0],N=v[1],w=Object(c.useState)([]),k=Object(i.a)(w,2),M=k[0],E=k[1],D=e.onDateChange;Object(c.useEffect)((function(){for(var e=[],t=new Date,n=new Date(u,o,1).getDay(),c=new Date(u,o+1,0).getDate()+n,s=1-n,a=0;a<c;a++){var r=new Date(u,o,s),i={id:s,upComming:s>0&&(T(r,t)||P(r,t))};e.push(i),s++}E(e)}),[o,u]);var P=function(e,t){return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},T=function(e,t){return e>t},F=function(e){j(parseInt(e.target.id))},_=function(e){x(o),N(u),a(parseInt(e.target.id)),D(parseInt(e.target.id),o,u)};return Object(f.jsx)("div",{children:Object(f.jsxs)("div",{className:"calendar-picker",children:[Object(f.jsx)("div",{style:{display:"flex",margin:"10px 3px",borderBottom:"2px solid #f2f2f2"},children:Object(f.jsx)("h3",{style:{margin:"auto",fontSize:25},children:"".concat(s," ").concat(C[p].month," ").concat(y)})}),Object(f.jsxs)("div",{style:{textAlign:"center"},children:[Object(f.jsx)("button",{onClick:function(){u>1970&&h(u-1)},className:"float-start circle",children:Object(f.jsx)(S.a,{size:25})}),Object(f.jsx)("span",{style:{fontSize:20},children:u}),Object(f.jsx)("button",{onClick:function(){h(u+1)},className:"float-end circle",children:Object(f.jsx)(S.b,{size:25})})]}),Object(f.jsx)("div",{className:"month-picker py-2",children:Object(f.jsx)("div",{className:"month-grid",children:C.map((function(e){return Object(f.jsx)("div",{className:"".concat(parseInt(e.value)==parseInt(o)?"month-item-active":""," month-item"),children:Object(f.jsx)("button",{id:e.value,onClick:F,children:e.month})},e.value)}))})}),Object(f.jsxs)("div",{className:"date-grid py-2",children:[A.map((function(e,t){return Object(f.jsx)("div",{className:"date-item date-item-header",children:Object(f.jsx)("div",{style:{margin:"auto"},children:e})},t)})),M.map((function(e){var t=e.upComming?"date-item-upcomming":"",n=e.id==s&&o==p&&u==y?"date-item-active":"";return Object(f.jsx)("div",{className:"date-item ".concat(t," ").concat(n),children:Object(f.jsx)("button",{disabled:!e.upComming,onClick:_,id:e.id,children:Object(f.jsx)("div",{id:e.id,children:Object(f.jsx)("p",{id:e.id,children:e.id>0&&e.id})})})},e.id)}))]})]})})};var M=function(e){var t=Object(c.useState)([]),n=Object(i.a)(t,2),s=n[0],a=n[1],r=Object(c.useState)([]),l=Object(i.a)(r,2),o=l[0],j=l[1],d=Object(c.useState)(""),b=Object(i.a)(d,2),u=b[0],h=b[1],m=Object(c.useState)(!1),O=Object(i.a)(m,2),x=O[0],g=O[1],v=Object(c.useRef)(!0);return Object(c.useEffect)((function(){return function(){v.current=!1}}),[]),Object(c.useEffect)((function(){g(!0);var t=new Date(e.fullDate),n=t.getDay();t=t.toUTCString(),fetch("".concat(p,"/api/availability/offertime?day=").concat(n,"&duration=").concat(e.duration,"&utcDate=").concat(t),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){if(!v.current)return null;if(!e.success)throw new Error(e.message);if(0===e.times.length)throw new Error("Not available. Check other days or decrease session time.");g(!1),a([]),e.times.sort((function(e,t){return new Date(e)-new Date(t)})),j(e.times)})).catch((function(e){if(!v.current)return null;j([]),g(!1),Array.isArray(e)?a(e):a([e.message]),console.log(e)}))}),[e.fullDate,e.duration,e.dummy]),Object(f.jsxs)("div",{children:[x?Object(f.jsx)("div",{style:{margin:"auto",textAlign:"center"},children:Object(f.jsx)("div",{className:"spinner-border text-warning",role:"status"})}):Object(f.jsx)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center"},children:o.map((function(t,n){var c=function(e){return 60*e.getHours()+e.getMinutes()}(new Date(t)),s=function(e){var t=Math.floor(e/60),n=t>=12?"PM":"AM",c=(e%60+"0").substring(0,2);return"".concat((t+11)%12+1,":").concat(c," ").concat(n)}(c);return Object(f.jsx)("button",{type:"button",value:s,className:"btn ".concat(s==u?"btn-primary":"btn-secondary"," mx-1 my-1"),style:{width:80,fontSize:12},onClick:function(t){h(s),e.onTimeSelected(s)},children:s},n)}))}),s.map((function(e,t){return Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:e},t)}))]})},E=n(20);var D=function(e){var t=Object(c.useState)([]),n=Object(i.a)(t,2),s=n[0],a=n[1],r=Object(c.useState)(null),l=Object(i.a)(r,2),o=l[0],j=l[1],d=Object(c.useRef)(!0),b=Object(c.useState)(!1),u=Object(i.a)(b,2),h=u[0],m=u[1],O=Object(c.useState)(""),x=Object(i.a)(O,2),g=x[0],v=x[1];return Object(c.useEffect)((function(){if(!d.current)return null;m(!0),v("");return fetch("".concat(p,"/api/lesson/active"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){if(!e.success)throw new Error(e.message);if(!e.lessons.length)throw new Error("We are sorry. No lesson is available now.");if(!d.current)return null;a(e.lessons),m(!1),v("")})).catch((function(e){if(!d.current)return null;console.log(e.message),m(!1),v(e.message)})),function(){d.current=!1}}),[]),Object(f.jsxs)("div",{children:[h?Object(f.jsx)(E.EatLoading,{color:"orange"}):g&&Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:g}),Object(f.jsx)("div",{className:"class-offer-flex",children:s.map((function(t){return Object(f.jsxs)("div",{className:"class-offer my-2 ".concat(o==t.lesson_id?"class-offer-active":"class-offer-inactive"),onClick:function(){j(t.lesson_id),e.selectLesson({lessonId:t.lesson_id,lessonName:t.lesson_name,price30m:t.price_30m,price60m:t.price_60m})},children:[Object(f.jsx)("h3",{children:t.lesson_name}),Object(f.jsx)("p",{children:"description:"}),Object(f.jsxs)("p",{children:["$ ",t.description]}),Object(f.jsxs)("p",{children:["30 minutes: $",t.price_30m]}),Object(f.jsxs)("p",{children:["60 minutes: $",t.price_60m]})]},t.lesson_id)}))})]})},P=new Date,T=P.getDate(),F=P.getMonth()+1,_=P.getFullYear(),L="".concat(_,"-").concat(F,"-").concat(T);var I=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(""),r=Object(i.a)(a,2),l=r[0],o=r[1],j=Object(c.useState)(""),d=Object(i.a)(j,2),b=d[0],u=d[1],h=Object(c.useState)(""),m=Object(i.a)(h,2),O=m[0],x=m[1],g=Object(c.useState)(60),v=Object(i.a)(g,2),y=v[0],N=v[1],S=Object(c.useState)(L),C=Object(i.a)(S,2),A=C[0],E=C[1],P=Object(c.useState)(null),I=Object(i.a)(P,2),R=I[0],z=I[1],W=Object(c.useState)(""),J=Object(i.a)(W,2),q=J[0],H=J[1],U=Object(c.useState)([]),Y=Object(i.a)(U,2),$=Y[0],V=Y[1],B=Object(c.useState)(!1),G=Object(i.a)(B,2),X=G[0],Z=G[1],K=Object(c.useState)(!1),Q=Object(i.a)(K,2),ee=Q[0],te=Q[1],ne=Object(c.useState)(0),ce=Object(i.a)(ne,2),se=ce[0],ae=ce[1],re=Object(c.useRef)(!0);Object(c.useEffect)((function(){return function(){re.current=!1}}),[]),Object(c.useEffect)((function(){H("")}),[A,y]);var ie=function(){var e=[].concat(Object(w.a)(R?[]:["Lesson is missing. Please select a lesson"]),Object(w.a)(A?[]:["Date is missing. Please select date"]),Object(w.a)(q?[]:["Time is missing. Please select time."]),Object(w.a)(n?[]:["Name is required."]),Object(w.a)(l?[]:["Email address is required."]),Object(w.a)(y>0&&y%30==0?[]:["Select session duration."]));if(e.length)return V(e);var t=new Date("".concat(A," ").concat(q));t=t.toUTCString();var c={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({name:n,email:l,phone:b,note:O,date:t,duration:y,lessonId:R.lessonId})};Z(!0),V([]),fetch("".concat(p,"/api/booking"),c).then((function(e){return e.json()})).then((function(e){if(!re.current)return null;if(!e.success)throw new Error(e.message);V([]),Z(!1),H(""),ae(se+1),te(!0),setTimeout((function(){if(!re.current)return null;te(!1)}),7e3)})).catch((function(e){if(!re.current)return null;Array.isArray(e)?V(e):V([e.message]),Z(!1)}))};return Object(f.jsxs)("div",{style:{maxWidth:600,margin:"auto",padding:"0px 0px 150px 0px"},children:[Object(f.jsxs)("section",{className:"booking",children:[Object(f.jsx)("div",{className:"guide-banner",children:Object(f.jsx)("h3",{children:"Select class"})}),Object(f.jsx)(D,{selectLesson:z})]}),Object(f.jsxs)("section",{className:"booking",children:[Object(f.jsx)("div",{className:"guide-banner",children:Object(f.jsx)("h3",{children:"Select session duration"})}),Object(f.jsx)("div",{children:Object(f.jsx)("div",{style:{width:200,margin:"20px auto"},children:Object(f.jsxs)("select",{className:"form-select",defaultValue:y,"aria-label":"Default select example",onChange:function(e){N(e.target.value)},children:[Object(f.jsx)("option",{value:"30",children:"30 minutes"}),Object(f.jsx)("option",{value:"60",children:"1 hour"}),Object(f.jsx)("option",{value:"90",children:"1 hour 30 minutes"}),Object(f.jsx)("option",{value:"120",children:"2 hours"}),Object(f.jsx)("option",{value:"150",children:"2 hours 30 minutes"}),Object(f.jsx)("option",{value:"180",children:"3 hours"}),Object(f.jsx)("option",{value:"210",children:"3 hours 30 minutes"}),Object(f.jsx)("option",{value:"240",children:"4 hours"})]})})})]}),Object(f.jsxs)("section",{className:"booking",children:[Object(f.jsx)("div",{className:"guide-banner",children:Object(f.jsx)("h3",{children:"Select date"})}),Object(f.jsx)(k,{date:T,month:F-1,year:_,onDateChange:function(e,t,n){E(n+"-"+(t+1)+"-"+e)}})]}),Object(f.jsxs)("section",{className:"booking",children:[Object(f.jsx)("div",{className:"guide-banner",children:Object(f.jsx)("h3",{children:"Select time"})}),Object(f.jsx)(M,{duration:y,fullDate:A,onTimeSelected:H,dummy:se})]}),Object(f.jsxs)("section",{className:"booking",children:[Object(f.jsx)("div",{className:"guide-banner",children:Object(f.jsx)("h3",{children:"Your information"})}),Object(f.jsxs)("form",{className:"form-default-box",children:[Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsxs)("label",{htmlFor:"name",className:"form-label",children:[Object(f.jsx)("b",{children:"Name"})," "]}),Object(f.jsx)("input",{type:"text",length:50,className:"form-control",id:"name",required:!0,onChange:function(e){s(e.target.value)}})]}),Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"email",className:"form-label",children:Object(f.jsx)("b",{children:"Email"})}),Object(f.jsx)("input",{type:"email",length:50,className:"form-control",id:"email",required:!0,onChange:function(e){o(e.target.value)}})]}),Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"phone",className:"form-label",children:Object(f.jsx)("b",{children:"Phone"})}),Object(f.jsx)("input",{type:"tel",length:20,className:"form-control",id:"phone",onChange:function(e){u(e.target.value)}})]}),Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"note",className:"form-label",children:Object(f.jsx)("b",{children:"Note"})}),Object(f.jsx)("textarea",{className:"form-control",id:"description",rows:5,wrap:"soft",onChange:function(e){x(e.target.value)}})]})]})]}),Object(f.jsxs)("section",{className:"booking",children:[Object(f.jsx)("div",{className:"guide-banner",children:Object(f.jsx)("h3",{children:"Confirm details & Book appointment"})}),Object(f.jsx)("table",{className:"table mb-4",style:{margin:"auto",maxWidth:600},children:Object(f.jsxs)("tbody",{children:[Object(f.jsx)("tr",{className:"table-primary",children:Object(f.jsx)("td",{colSpan:"2",children:Object(f.jsx)("b",{children:"Your information"})})}),Object(f.jsxs)("tr",{className:"table-light",children:[Object(f.jsx)("td",{className:"booking-info-tag",children:"Name"}),Object(f.jsx)("td",{children:n})]}),Object(f.jsxs)("tr",{className:"table-light",children:[Object(f.jsx)("td",{className:"booking-info-tag",children:"Email"}),Object(f.jsx)("td",{children:l})]}),Object(f.jsxs)("tr",{className:"table-light",children:[Object(f.jsx)("td",{className:"booking-info-tag",children:"Phone"}),Object(f.jsx)("td",{children:b})]}),Object(f.jsxs)("tr",{className:"table-light",children:[Object(f.jsx)("td",{className:"booking-info-tag",style:{verticalAlign:"top"},children:"Note"}),Object(f.jsx)("td",{children:O})]}),Object(f.jsx)("tr",{className:"table-primary",children:Object(f.jsx)("td",{colSpan:"2",children:Object(f.jsx)("b",{children:"Appointment information"})})}),Object(f.jsxs)("tr",{className:"table-light",children:[Object(f.jsx)("td",{className:"booking-info-tag",children:"Class"}),Object(f.jsx)("td",{children:R&&R.lessonName})]}),Object(f.jsxs)("tr",{className:"table-light",children:[Object(f.jsx)("td",{className:"booking-info-tag",children:"Class ID"}),Object(f.jsx)("td",{children:R&&R.lessonId})]}),Object(f.jsxs)("tr",{className:"table-light",children:[Object(f.jsx)("td",{className:"booking-info-tag",children:"Date"}),Object(f.jsx)("td",{children:A})]}),Object(f.jsxs)("tr",{className:"table-light",children:[Object(f.jsx)("td",{className:"booking-info-tag",children:"Time"}),Object(f.jsx)("td",{children:q})]}),Object(f.jsxs)("tr",{className:"table-light",children:[Object(f.jsx)("td",{className:"booking-info-tag",children:"Duration"}),Object(f.jsxs)("td",{children:[y," minutes"]})]}),Object(f.jsxs)("tr",{className:"table-light",children:[Object(f.jsx)("td",{className:"booking-info-tag",children:"Fee"}),Object(f.jsxs)("td",{children:["$",R&&R.price60m*Math.floor(y/60)+R.price30m*(y%60==30?1:0)," (pay at the study date)"]})]})]})}),$.length>0&&Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:Object(f.jsx)("ul",{children:$.map((function(e,t){return Object(f.jsx)("li",{children:e},t)}))})}),ee&&Object(f.jsxs)("div",{className:"alert alert-success",role:"alert",children:[Object(f.jsx)("p",{children:"Successfully booked.Booking details will be sent to your email address."}),Object(f.jsx)("p",{children:"You can continue booking on this page."})]}),X?Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:"Loading..."})]})}):Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsx)("button",{className:"btn btn-primary",onClick:function(){ie()},children:"Book now"})})]})]})};var R=function(e){var t=Object(c.useState)([{id:0,day:"Sun",isChecked:!1},{id:1,day:"Mon",isChecked:!1},{id:2,day:"Tu",isChecked:!1},{id:3,day:"Wed",isChecked:!1},{id:4,day:"Th",isChecked:!1},{id:5,day:"Fri",isChecked:!1},{id:6,day:"Sat",isChecked:!1},{id:7,day:"Everyday",isChecked:!1}]),n=Object(i.a)(t,1)[0],s=Object(c.useState)(!1),a=Object(i.a)(s,2),r=a[0],l=a[1],o=Object(c.useState)([]),j=Object(i.a)(o,2),d=j[0],b=j[1],u=Object(c.useState)(""),h=Object(i.a)(u,2),m=h[0],O=h[1],x=Object(c.useState)(0),g=Object(i.a)(x,2),v=g[0],y=g[1],N=Object(c.useState)(0),w=Object(i.a)(N,2),S=w[0],C=w[1],A=Object(c.useState)("AM"),k=Object(i.a)(A,2),M=k[0],E=k[1],D=Object(c.useState)(0),P=Object(i.a)(D,2),T=P[0],F=P[1],_=Object(c.useState)(0),L=Object(i.a)(_,2),I=L[0],R=L[1],z=Object(c.useState)("AM"),W=Object(i.a)(z,2),J=W[0],q=W[1],H=Object(c.useState)(0),U=Object(i.a)(H,2),Y=U[0],$=U[1],V=Object(c.useRef)(!0);Object(c.useEffect)((function(){return function(){V.current=!1}}),[]);var B=function(){var e="";return n.forEach((function(t){t.isChecked&&(e+=t.id)})),e};return Object(f.jsx)("div",{children:Object(f.jsx)("div",{className:"mt-3 mb-3",children:Object(f.jsxs)("form",{className:"form-default-box",onSubmit:function(t){t.preventDefault();var n=60*(1*v+("AM"===M?0:12))+1*S,c=1*T==0&&1*I==0&&"AM"==J?1440:60*(1*T+("AM"===J?0:12))+1*I;if(n>=c)return b(["Incorrect time."]);if(!V.current)return null;if(b([]),l(!0),!B())return O("At least one day must be selected."),void l(!1);O("");var s={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({timeFrom:n,timeTo:c,days:B()}),credentials:"include"};fetch("".concat(p,"/api/availability/"),s).then((function(e){if(401===e.status)throw new Error("Unauthorized.");return e})).then((function(e){return e.json()})).then((function(t){if(!V.current)return null;if(!t.success)throw new Error(t.message);e.handleClose(),e.signalAddSuccess()})).catch((function(e){if(!V.current)return null;Array.isArray(e)?b(e):b([e.message]),l(!1)}))},style:{margin:"auto",maxWidth:320},children:[Object(f.jsx)("div",{className:"py-1",style:{textAlign:"center"},children:Object(f.jsx)("b",{children:"From"})}),Object(f.jsxs)("div",{style:{margin:"5px auto",width:"100%",textAlign:"center"},children:[Object(f.jsx)("div",{style:{display:"inline-block"},children:Object(f.jsxs)("select",{className:"form-select",defaultValue:v,name:"fromH",id:"fromH",onChange:function(e){y(e.target.value)},children:[Object(f.jsx)("option",{value:"0",children:"12"}),Object(f.jsx)("option",{value:"1",children:"01"}),Object(f.jsx)("option",{value:"2",children:"02"}),Object(f.jsx)("option",{value:"3",children:"03"}),Object(f.jsx)("option",{value:"4",children:"04"}),Object(f.jsx)("option",{value:"5",children:"05"}),Object(f.jsx)("option",{value:"6",children:"06"}),Object(f.jsx)("option",{value:"7",children:"07"}),Object(f.jsx)("option",{value:"8",children:"08"}),Object(f.jsx)("option",{value:"9",children:"09"}),Object(f.jsx)("option",{value:"10",children:"10"}),Object(f.jsx)("option",{value:"11",children:"11"})]})}),"\xa0",Object(f.jsx)("b",{children:":"}),"\xa0",Object(f.jsx)("div",{style:{display:"inline-block"},children:Object(f.jsxs)("select",{className:"form-select",defaultValue:S,name:"fromM",id:"fromM",onChange:function(e){C(e.target.value)},children:[Object(f.jsx)("option",{value:"0",children:"00"}),Object(f.jsx)("option",{value:"30",children:"30"})]})}),"\xa0",Object(f.jsx)("div",{style:{display:"inline-block"},children:Object(f.jsxs)("select",{className:"form-select",defaultValue:M,name:"fromAP",id:"fromAP",onChange:function(e){E(e.target.value)},children:[Object(f.jsx)("option",{value:"AM",children:"AM"}),Object(f.jsx)("option",{value:"PM",children:"PM"})]})})]}),Object(f.jsx)("div",{className:"py-1",style:{textAlign:"center"},children:Object(f.jsx)("b",{children:"To"})}),Object(f.jsxs)("div",{style:{margin:"5px auto",width:"100%",textAlign:"center"},children:[Object(f.jsx)("div",{style:{display:"inline-block"},children:Object(f.jsxs)("select",{className:"form-select",defaultValue:T,name:"toH",id:"toH",onChange:function(e){F(e.target.value)},children:[Object(f.jsx)("option",{value:"0",children:"12"}),Object(f.jsx)("option",{value:"1",children:"01"}),Object(f.jsx)("option",{value:"2",children:"02"}),Object(f.jsx)("option",{value:"3",children:"03"}),Object(f.jsx)("option",{value:"4",children:"04"}),Object(f.jsx)("option",{value:"5",children:"05"}),Object(f.jsx)("option",{value:"6",children:"06"}),Object(f.jsx)("option",{value:"7",children:"07"}),Object(f.jsx)("option",{value:"8",children:"08"}),Object(f.jsx)("option",{value:"9",children:"09"}),Object(f.jsx)("option",{value:"10",children:"10"}),Object(f.jsx)("option",{value:"11",children:"11"})]})}),"\xa0",Object(f.jsx)("b",{children:":"}),"\xa0",Object(f.jsx)("div",{style:{display:"inline-block"},children:Object(f.jsxs)("select",{className:"form-select",defaultValue:I,name:"toM",id:"toM",onChange:function(e){R(e.target.value)},children:[Object(f.jsx)("option",{value:"0",children:"00"}),Object(f.jsx)("option",{value:"30",children:"30"})]})}),"\xa0",Object(f.jsx)("div",{style:{display:"inline-block"},children:Object(f.jsxs)("select",{className:"form-select",defaultValue:J,name:"toAP",id:"toAP",onChange:function(e){q(e.target.value)},children:[Object(f.jsx)("option",{value:"AM",children:"AM"}),Object(f.jsx)("option",{value:"PM",children:"PM"})]})})]}),Object(f.jsx)("div",{className:"form-check",children:n.map((function(e){return Object(f.jsxs)("div",{children:[Object(f.jsx)("input",{className:"form-check-input",type:"checkbox",id:e.id,onChange:function(e){!function(e){if(7==e.target.id){for(var t=!1,c=0;c<n.length-1;c++)n[c].isChecked||(n[c].isChecked=!0,t=!0);if(t)n[n.length-1].isChecked=!0;else for(var s=0;s<n.length;s++)n[s].isChecked=!1}else for(var a=0;a<n.length-1;a++)e.target.id==n[a].id&&(n[a].isChecked=e.target.checked,n[7].isChecked=!1);$(Y+1)}(e)},checked:e.isChecked}),Object(f.jsx)("label",{className:"form-check-label",htmlFor:e.id,children:e.day})]},e.id)}))}),m&&Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:m}),d.map((function(e,t){return Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:e},t)})),Object(f.jsxs)("div",{style:{width:"100%",height:20,marginTop:20},children:[Object(f.jsx)("button",{type:"button",className:"btn btn-danger d-inline-block float-start",onClick:function(){return e.handleClose()},children:"Cancel"}),r?Object(f.jsxs)("button",{className:"btn btn-primary float-end",type:"button",disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:"Loading..."})]}):Object(f.jsx)("button",{type:"submit",className:"btn btn-primary d-inline-block float-end",children:"Add"})]})]})})})};var z=function(e){var t=e.availability,n=e.removeAvailability,s=Object(c.useState)(!1),a=Object(i.a)(s,2),r=a[0],l=a[1],o=Object(c.useState)(""),j=Object(i.a)(o,2),d=j[0],b=j[1],u=Object(c.useRef)(!0),h=["Sun","Mon","Tu","Wed","Th","Fri","Sat"],m=function(e){if(1440==e)return"12:00 AM";var t=Math.floor(e/60),n=t>=12?"PM":"AM",c=(e%60+"0").substring(0,2);return t="".concat((t+11)%12+1,":").concat(c," ").concat(n)},O=m(t.start_minute),x=m(t.end_minute);return Object(f.jsx)("div",{children:Object(f.jsx)("div",{className:"mb-2 pd-4 default-wrapper mw-400",children:Object(f.jsxs)("div",{className:"",children:[Object(f.jsxs)("div",{className:"mb-2",children:[function(){for(var e=[0,0,0,0,0,0,0],n=t.days,c=0;c<n.length;c++)e[n[c]]=1;return Object(f.jsx)("div",{style:{margin:"10px auto"},children:e.map((function(e,t){return Object(f.jsx)("div",{style:{display:"inline-block",textAlign:"center",minWidth:40,color:e?"orange":"#eee"},children:h[t]},t)}))})}(),Object(f.jsx)("p",{className:"mb-1 text-secondary",children:Object(f.jsx)("b",{children:O==x?"All day":"".concat(O," - ").concat(x)})})]}),d&&Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:d}),Object(f.jsx)("div",{style:{height:30},children:r?Object(f.jsxs)("button",{className:"btn btn-danger py-1 float-end",type:"button",disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:"Deleting..."})]}):Object(f.jsxs)("button",{onClick:function(){l(!0),b("");fetch("".concat(p,"/api/availability/delete/").concat(t.availability_id),{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(!e.success)throw new Error(e.message);if(!u.current)return null;l(!1),b(""),n(t.availability_id)})).catch((function(e){if(!u.current)return null;l(!1),b(e.message)}))},type:"button",title:"delete",className:"btn btn-danger py-1 float-end",children:[Object(f.jsx)(v.a,{size:20}),Object(f.jsx)("span",{className:"align-middle button-text",style:{fontSize:10},children:"DELETE"})]})})]})})})};var W=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],s=t[1],a=Object(c.useRef)(!0),r=Object(c.useState)(!1),l=Object(i.a)(r,2),o=l[0],j=l[1],d=Object(c.useState)(!1),b=Object(i.a)(d,2),u=b[0],h=b[1],m=Object(c.useState)(0),O=Object(i.a)(m,2),x=O[0],g=O[1],v=Object(c.useState)(!1),y=Object(i.a)(v,2),N=y[0],w=y[1],S=Object(c.useState)(""),C=Object(i.a)(S,2),A=C[0],k=C[1];function M(e,t){return e.days<t.days?-1:e.days>t.days?1:0}Object(c.useEffect)((function(){return function(){a.current=!1}}),[]),Object(c.useEffect)((function(){if(!a.current)return null;w(!0),k("");fetch("".concat(p,"/api/availability/all"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){if(!a.current)return null;if(!e.success)throw new Error(e.message);e.data.sort(M),s(e.data),k(""),w(!1)})).catch((function(e){if(!a.current)return null;console.log(e.message),k(e.message),w(!1)}))}),[x]);var E=function(e){s(n.filter((function(t){return t.availability_id!=e})))};return Object(f.jsxs)("div",{className:"mt-3",children:[u&&Object(f.jsx)("div",{className:"alert alert-success",role:"alert",children:"Successfully added."}),o?Object(f.jsx)(R,{signalAddSuccess:function(){h(!0),g(x+1),setTimeout((function(){h(!1)}),2e3)},handleClose:function(){return j(!1)}}):Object(f.jsxs)("div",{style:{textAlign:"center"},children:[Object(f.jsx)("button",{type:"button",className:"btn btn-primary mb-5",onClick:function(){return j(!0)},children:"Add availability"}),Object(f.jsx)("br",{}),Object(f.jsx)("button",{className:"btn btn-primary mb-5",onClick:function(){window.location.href="/api/unavailable/"},children:"set time unavailable"})]}),N?Object(f.jsx)("div",{className:"text-center",children:Object(f.jsx)("div",{className:"spinner-border",role:"status",style:{color:"orange"}})}):A&&Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:A}),n.map((function(e){return Object(f.jsx)(z,{removeAvailability:E,availability:e},e.availability_id)}))]})},J=n(29),q=n.n(J),H=n(37);var U=function(e){var t=e.show,n=e.onClose,s=e.title,a=e.children;return Object(c.useEffect)((function(){var e=function(e){27===e.keyCode&&n()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}})),Object(f.jsx)("div",{className:"app-modal ".concat(t?"show":""),onClick:n,children:Object(f.jsxs)("div",{className:"app-modal-content",onClick:function(e){e.stopPropagation()},children:[Object(f.jsx)("div",{className:"modal-header",children:Object(f.jsx)("h4",{className:"app-modal-title",children:s})}),Object(f.jsx)("div",{className:"app-modal-body",children:a}),Object(f.jsx)("div",{className:"app-modal-footer",children:Object(f.jsx)("button",{className:"btn btn-secondary",onClick:n,children:"Close"})})]})})};var Y=function(e){var t=e.id,n=e.onUpdate,s=Object(c.useState)(null),a=Object(i.a)(s,2),r=a[0],l=a[1],o=Object(c.useState)(!1),j=Object(i.a)(o,2),d=j[0],b=j[1],u=Object(c.useState)(""),h=Object(i.a)(u,2),m=h[0],O=h[1],x=Object(c.useState)(!1),g=Object(i.a)(x,2),v=g[0],y=g[1],N=Object(c.useState)(""),w=Object(i.a)(N,2),S=w[0],C=w[1],A=Object(c.useState)(!1),k=Object(i.a)(A,2),M=k[0],E=k[1],D=Object(c.useState)(""),P=Object(i.a)(D,2),T=P[0],F=P[1],_=Object(c.useRef)(!0);Object(c.useEffect)((function(){return function(){_.current=!1}}),[]),Object(c.useEffect)((function(){if(!t)return console.log("id is null"),void l(null);b(!0),O("");console.log("id is: ",t),fetch("".concat(p,"/api/appointment/id/").concat(t),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(!_.current)return null;if(!e.success)throw new Error(e.message);b(!1),O(""),console.log(e.appointment),l(e.appointment)})).catch((function(e){if(!_.current)return null;console.log(e),b(!1),O(e.message)}))}),[t]);var L=function(e){var t=Math.floor(e/60),n=t>=12?"PM":"AM",c=(e%60+"0").substring(0,2);return t="".concat((t+11)%12+1,":").concat(c," ").concat(n)};return Object(f.jsxs)("div",{className:"mb-2",children:[Object(f.jsxs)("div",{className:"appointment-info-upcoming-wrapper py-2 px-2",children:[d?Object(f.jsx)("div",{className:"text-center",children:Object(f.jsx)("div",{className:"spinner-border",role:"status"})}):m&&Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:m}),r&&Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{style:{color:"black"},children:Object(f.jsxs)("b",{children:["Datetime: ",function(e,t){var n=e.getDate(),c=e.getMonth()+1,s=e.getFullYear(),a=L(60*Math.floor(e.getHours())+e.getMinutes()),r=L(60*Math.floor(e.getHours())+e.getMinutes()+t);return"".concat(n,"/").concat(c,"/").concat(s," ").concat(a," - ").concat(r)}(new Date(r.appointment_start),r.duration)," (",r.duration," minutes)"]})}),Object(f.jsxs)("p",{children:[Object(f.jsx)("b",{children:"Appointment ID: "}),r.appointment_id]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("b",{children:"Lesson: "}),r.lesson_name]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("b",{children:"Customer: "}),r.customer_name]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("b",{children:"Email: "}),r.customer_email]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("b",{children:"Phone: "}),r.customer_phone]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("b",{children:"Note: "}),r.note]}),Object(f.jsxs)("p",{children:[Object(f.jsx)("b",{children:"Fee: "}),"$",r.fee]})]})]}),Object(f.jsx)("div",{className:"mt-2",children:v?Object(f.jsx)("div",{children:Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id:r.appointment_id,message:S}),credentials:"include"};E(!0),F(""),fetch("".concat(p,"/api/appointment/admincancel?id=").concat(r.appointment_id,"}"),t).then((function(e){return e.json()})).then((function(e){if(!_.current)return null;if(!e.success)throw new Error(e.message);n()})).catch((function(e){console.log(e),E(!1),F(e.message)}))},className:"py-2",children:[Object(f.jsx)("textarea",{onChange:function(e){e.target.style.height="",e.target.style.height=Math.min(e.target.scrollHeight,300)+"px",C(e.target.value)},className:"form-control",id:"cancelText",rows:5,wrap:"soft",placeholder:"write message here"}),T&&Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:T}),M?Object(f.jsxs)("button",{className:"btn btn-primary float-end",type:"button",disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:"Loading..."})]}):Object(f.jsx)("button",{type:"submit",title:"delete",className:"btn btn-danger my-2 float-end",children:Object(f.jsx)("span",{className:"align-middle button-text",style:{fontSize:12},children:"confirm cancellation"})})]})}):Object(f.jsx)("button",{className:"btn btn-danger float-end",onClick:function(){return y(!0)},children:"cancel appointment"})})]})},$=n(38);var V=function(){var e=Object(c.useState)(null),t=Object(i.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(""),r=Object(i.a)(a,2),l=r[0],o=r[1],j=Object(c.useState)([]),d=Object(i.a)(j,2),b=d[0],u=d[1],h=Object(c.useState)([]),m=Object(i.a)(h,2),O=m[0],x=m[1],g=Object(c.useState)(!1),v=Object(i.a)(g,2),y=v[0],N=v[1],w=Object(c.useState)(""),C=Object(i.a)(w,2),A=C[0],k=C[1],M=Object(c.useState)(""),E=Object(i.a)(M,2),D=E[0],P=E[1],T=Object(c.useState)(0),F=Object(i.a)(T,2),_=F[0],L=F[1],I=Object(c.useRef)(!0),R=function(e){e.setDate(e.getDate()-e.getDay()),e.setHours(0),e.setMinutes(0),e.setSeconds(0)};Object(c.useEffect)((function(){var e=new Date;return o(X(e)),R(e),s(e),function(){I.current=!1}}),[]),Object(c.useEffect)((function(){if(n){var e=[],t=new Date(n);R(t);for(var c=0;c<7;c++){var s=new Date(t).setDate(t.getDate()+c);e.push(s)}u(e)}}),[n]),Object(c.useEffect)((function(){var e=function(){return new Promise((function(e,t){fetch("".concat(p,"/api/appointment/week?utcDate=").concat(n.toUTCString()),{credentials:"include"}).then((function(e){return e.json()})).then((function(t){if(!I)return null;if(!t.success)throw new Error(t.message);var n=t.appointments.map((function(e){return{appointmentId:e.appointment_id,customerName:e.customer_name,lessonName:e.lesson_name,appointmentStart:new Date(e.appointment_start),duration:e.duration,minuteStart:W(new Date(e.appointment_start))}}));e(n)})).catch((function(e){t(e)}))}))};function t(){return t=Object(H.a)(q.a.mark((function t(){var c,s,a,r,i,l,o,j,d,u;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(b.length&&n){t.next=2;break}return t.abrupt("return");case 2:return k(""),N(!0),t.next=6,e().catch((function(e){k(e.message),N(!1)}));case 6:if(c=t.sent){t.next=10;break}return x([]),t.abrupt("return");case 10:for(s=c.length?c[0].minuteStart:0,a=1;a<c.length;a++)c[a].minuteStart<s&&(s=c[a].minuteStart);for(r=Math.floor(s/30),i=["12:00 AM","12:30 AM","1:00 AM","1:30 AM","2:00 AM","2:30 AM","3:00 AM","3:30 AM","4:00 AM","4:30 AM","5:00 AM","5:30 AM","6:00 AM","6:30 AM","7:00 AM","7:30 AM","8:00 AM","8:30 AM","9:00 AM","9:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM","9:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM"].splice(r),l=new Array(i.length),o=0;o<l.length;o++)l[o]=["","","","","","","",""];for(j=0;j<l.length;j++)l[j][0]={type:"time",data:i[j]};d=new Date(b[0]),(u=new Date(d)).setDate(u.getDate()+7),c.forEach((function(e){var t=e.duration,n=new Date(e.appointmentStart);if(n>=d&&n<u){var c=n.getDay()+1,a=Math.floor((e.minuteStart-s)/30);l[a][c]={type:"appointment",data:e};for(var r=Math.floor(t/30)-1,i=0;i<r;i++)l[++a][c]={type:"spanned"}}})),N(!1),k(""),x(l);case 25:case"end":return t.stop()}}),t)}))),t.apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[b,_]);var z=function(){L(_+1)},W=function(e){return 60*e.getHours()+e.getMinutes()},J=function(e){var t=new Date(n);t.setDate(t.getDate()+7*e);var c=new Date(l);c.setDate(c.getDate()+7*e),o(X(c)),s(t)},V=function(e){var t=Math.floor(e/60),n=t>=12?"PM":"AM",c=(e%60+"0").substring(0,2);return t="".concat((t+11)%12+1,":").concat(c," ").concat(n)},B=function(e,t){var n=V(60*Math.floor(e.getHours())+e.getMinutes()),c=V(60*Math.floor(e.getHours())+e.getMinutes()+t);return"".concat(n," - ").concat(c)},G=function(e){e.preventDefault(),P(e.currentTarget.id)};function X(e){var t=new Date(e),n=""+(t.getMonth()+1),c=""+t.getDate(),s=t.getFullYear();return n.length<2&&(n="0"+n),c.length<2&&(c="0"+c),[s,n,c].join("-")}return Object(f.jsxs)("div",{children:[A&&Object(f.jsx)("div",{className:"alert alert-danger",role:"alert",children:A}),Object(f.jsxs)("div",{className:"mx-auto text-center",style:{overflowY:"auto",maxHeight:"100vh"},children:[Object(f.jsx)("div",{className:"mw-1000 mx-auto my-3",children:Object(f.jsx)("input",{type:"date",value:l,onChange:function(e){var t=new Date(e.target.value);o(X(t)),R(t),s(t)}})}),Object(f.jsx)("div",{className:"mw-1000 mx-auto",style:{overflowX:"scroll",maxHeight:"90vh"},children:Object(f.jsxs)("table",{className:"calendar",style:y?{backgroundColor:"#efefef"}:{},children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{className:"header-fixed",style:{maxWidth:60,padding:5},children:Object(f.jsxs)("div",{children:[Object(f.jsx)("button",{className:"float-start circle",onClick:function(){return J(-1)},children:Object(f.jsx)(S.a,{size:25})}),Object(f.jsx)("button",{className:"refresh",children:Object(f.jsx)($.a,{title:"refresh",color:"white",onClick:function(){return z()}})}),Object(f.jsx)("button",{className:"float-end circle",onClick:function(){return J(1)},children:Object(f.jsx)(S.b,{size:25})})]})}),b.map((function(e,t){var n=function(e){var t=new Date(e),n=t.getDate(),c=t.getMonth(),s=t.getFullYear();return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()]+" "+n+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][c]+" "+s}(e).split(" "),c=Object(i.a)(n,4),s=c[0],a=c[1],r=c[2],l=c[3];return Object(f.jsxs)("th",{className:"head-fixed",children:[Object(f.jsx)("p",{children:s}),Object(f.jsxs)("p",{children:[a," ",r," ",l]})]},t)}))]})}),Object(f.jsxs)("tbody",{children:[Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{className:"header-fixed"}),Object(f.jsx)("td",{colSpan:7,style:{height:"20px"}})]}),O.map((function(e,t){return Object(f.jsx)("tr",{children:e.map((function(e,t){switch(e.type){case"appointment":var n=e.data;return Object(f.jsx)("td",{className:"td-with-data",rowSpan:Math.floor(n.duration/30),children:Object(f.jsxs)("div",{id:n.appointmentId,onClick:G,children:[Object(f.jsx)("p",{children:B(n.appointmentStart,n.duration)}),Object(f.jsx)("p",{children:n.lessonName}),Object(f.jsx)("p",{children:n.customerName}),Object(f.jsxs)("p",{children:[n.duration," minutes"]}),Object(f.jsx)("p",{children:n.appointmentId})]})},t);case"time":return Object(f.jsx)("th",{className:"header-fixed",style:{verticalAlign:"top"},children:Object(f.jsx)("div",{style:{minHeight:25},children:Object(f.jsx)("p",{className:"time",style:{position:"absolute",top:-12,right:5},children:e.data})})},t);case"spanned":return null;default:return Object(f.jsx)("td",{},t)}}))},t)}))]})]})})]}),D&&Object(f.jsx)(U,{show:!!D,onClose:function(){return P("")},title:"Appointment: ".concat(D),children:Object(f.jsx)(Y,{id:D,onUpdate:function(){z(),P("")}})})]})};var B=function(){var e=Object(c.useRef)(!0),t=Object(c.useState)(!1),n=Object(i.a)(t,2),s=n[0],a=n[1],r=Object(c.useState)(""),l=Object(i.a)(r,2),o=l[0],j=l[1],d=Object(c.useState)(""),b=Object(i.a)(d,2),u=b[0],h=b[1],m=Object(c.useState)(""),O=Object(i.a)(m,2),x=O[0],g=O[1],v=Object(c.useState)(!1),y=Object(i.a)(v,2),N=y[0],w=y[1],S=Object(c.useState)([]),C=Object(i.a)(S,2),A=C[0],k=C[1],M=Object(c.useState)(!1),E=Object(i.a)(M,2),D=E[0],P=E[1];Object(c.useEffect)((function(){return function(){e.current=!1}}),[]);var T=function(){j(""),h(""),g("")};return Object(f.jsxs)("div",{children:[Object(f.jsxs)("p",{children:[Object(f.jsx)("b",{children:"Password"}),Object(f.jsx)("span",{className:"clickable",onClick:function(){a(!s)},children:"change password"})]}),Object(f.jsx)("div",{className:"subform",style:{display:s?"block":"none"},children:Object(f.jsxs)("form",{onSubmit:function(t){t.preventDefault(),console.log("current: ".concat(o)),console.log("pwd: ".concat(u)),console.log("confirm pwd: ".concat(x));var n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({currentPwd:o,newPwd:u,newPwdConfirm:x}),credentials:"include"};w(!1),k([]),P(!0),fetch("".concat(p,"/api/auth/changepassword"),n).then((function(e){return e.json()})).then((function(t){return e.current?t.success?(P(!1),w(!0),k([]),void T()):(k(t.message),P(!1),void w(!1)):null})).catch((function(t){if(!e.current)return null;k([t.message]),P(!1),w(!1)}))},children:[Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"currentPwd",className:"form-label",children:"CURRENT PASSWORD"}),Object(f.jsx)("input",{className:"form-control",type:"password",name:"currentPwd",id:"currentPwd",value:o,onChange:function(e){return j(e.target.value)},required:!0})]}),Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"newPwd",className:"form-label",children:"NEW PASSWORD"}),Object(f.jsx)("input",{className:"form-control",type:"password",name:"newPwd",id:"newPwd",value:u,onChange:function(e){return h(e.target.value)},required:!0})]}),Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"newPwdConfirm",className:"form-label",children:"CONFIRM NEW PASSWORD"}),Object(f.jsx)("input",{className:"form-control",type:"password",name:"newPwdConfirm",id:"newPwdConfirm",value:x,onChange:function(e){return g(e.target.value)},required:!0})]}),A.map((function(e,t){return Object(f.jsx)("div",{className:"alert alert-danger  show mt-3",role:"alert",children:e},t)})),N&&Object(f.jsx)("div",{className:"alert alert-success  show mt-3",role:"alert",children:"Successfully changed password."}),D?Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:" DONE"})]})}):Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsx)("button",{className:"btn btn-primary",type:"submit",children:"DONE"})})]})})]})};var G=function(){var e=Object(c.useRef)(!0),t=Object(c.useState)(""),n=Object(i.a)(t,2),s=n[0],a=n[1],r=Object(c.useState)(0),l=Object(i.a)(r,2),o=l[0],j=l[1],d=Object(c.useState)(!1),b=Object(i.a)(d,2),u=b[0],h=b[1],m=Object(c.useState)(""),O=Object(i.a)(m,2),x=O[0],g=O[1],v=Object(c.useState)(""),y=Object(i.a)(v,2),N=y[0],w=y[1],S=Object(c.useState)(""),C=Object(i.a)(S,2),A=C[0],k=C[1],M=Object(c.useState)(""),E=Object(i.a)(M,2),D=E[0],P=E[1],T=Object(c.useState)(!1),F=Object(i.a)(T,2),_=F[0],L=F[1],I=Object(c.useState)(""),R=Object(i.a)(I,2),z=R[0],W=R[1],J=Object(c.useState)(!1),q=Object(i.a)(J,2),H=q[0],U=q[1],Y=Object(c.useState)(""),$=Object(i.a)(Y,2),V=$[0],G=$[1];Object(c.useEffect)((function(){return function(){e.current=!1}}),[]),Object(c.useEffect)((function(){fetch("".concat(p,"/api/auth/userinfo"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(t){if(!e.current)return null;if(!t.success)throw new Error(t.message);a(t.email)})).catch((function(e){}))}),[o]);var X=function(){g(""),w(""),k(""),P(""),L(!1),W(""),U(!1),G("")};return Object(f.jsxs)("div",{className:"account-setting",children:[Object(f.jsxs)("div",{className:"mb-3 pb-3 bottom-border",children:[Object(f.jsxs)("p",{children:[Object(f.jsx)("b",{children:"Email"}),Object(f.jsx)("span",{children:s}),Object(f.jsx)("span",{className:"clickable",onClick:function(){h(!u),X()},children:"change email"})]}),u&&Object(f.jsxs)("div",{className:"subform",children:[Object(f.jsxs)("form",{onSubmit:function(t){t.preventDefault();var n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({currentEmail:s,newEmail:x,password:N}),credentials:"include"};L(!0),P(""),k(""),fetch("".concat(p,"/api/auth/changeemail/code"),n).then((function(e){return e.json()})).then((function(t){if(!e.current)return null;if(!t.success)throw new Error(t.message);L(!1),k(t.message)})).catch((function(t){if(console.log(t),!e.current)return null;L(!1),P(t.message),k("")}))},children:[Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"email",className:"form-label",children:"NEW EMAIL"}),Object(f.jsx)("input",{className:"form-control",type:"email",name:"email",id:"email",onChange:function(e){return g(e.target.value)},required:!0})]}),Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"password",className:"form-label",children:"CURRENT PASSWORD"}),Object(f.jsx)("input",{className:"form-control",type:"password",name:"password",id:"password",onChange:function(e){return w(e.target.value)},required:!0})]}),D&&Object(f.jsx)("div",{className:"alert alert-danger  show mt-3",role:"alert",children:D}),A&&Object(f.jsx)("div",{className:"alert alert-success  show mt-3",role:"alert",children:A}),_?Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:"SEND PASSCODE TO NEW EMAIL."})]})}):Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsx)("button",{className:"btn btn-primary",type:"submit",children:"SEND PASSCODE TO NEW EMAIL"})})]}),A&&Object(f.jsx)("div",{className:"mt-3",children:Object(f.jsxs)("form",{onSubmit:function(t){t.preventDefault();var n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({code:z}),credentials:"include"};U(!0),G(""),fetch("".concat(p,"/api/auth/changeemail/change"),n).then((function(e){return e.json()})).then((function(t){if(!e.current)return null;if(!t.success)throw new Error(t.message);X(),h(!1),j(o+1)})).catch((function(t){if(console.log("in error"),!e.current)return null;console.log(t),U(!1),G(t.message)}))},children:[Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"code",className:"form-label",children:"CODE"}),Object(f.jsx)("input",{className:"form-control",type:"text",name:"code",id:"code",onChange:function(e){return W(e.target.value)},required:!0})]}),V&&Object(f.jsx)("div",{className:"alert alert-danger  show mt-3",role:"alert",children:V}),H?Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsxs)("button",{className:"btn btn-primary",type:"submit",disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:"DONE"})]})}):Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsx)("button",{className:"btn btn-primary",type:"submit",children:"DONE"})})]})})]})]}),Object(f.jsx)(B,{})]})};var X=function(){return Object(f.jsx)("div",{children:Object(f.jsxs)("div",{style:{position:"relative"},children:[Object(f.jsx)(x,{}),Object(f.jsx)("div",{className:"content-wrapper",children:Object(f.jsxs)(o.c,{children:[Object(f.jsx)(o.a,{exact:!0,path:"/",children:Object(f.jsx)(V,{})}),Object(f.jsx)(o.a,{path:"/calendar",children:Object(f.jsx)(V,{})}),Object(f.jsx)(o.a,{path:"/lesson",children:Object(f.jsx)(N,{})}),Object(f.jsx)(o.a,{path:"/availability",children:Object(f.jsx)(W,{})}),Object(f.jsx)(o.a,{path:"/account",children:Object(f.jsx)(G,{})}),Object(f.jsx)(o.a,{path:"/booking",children:Object(f.jsx)(I,{})})]})})]})})};var Z=function(){var e=Object(c.useContext)(O).setUser,t=Object(c.useState)(""),n=Object(i.a)(t,2),s=n[0],a=n[1],r=Object(c.useState)(""),l=Object(i.a)(r,2),o=l[0],j=l[1],d=Object(c.useState)(!1),b=Object(i.a)(d,2),u=b[0],h=b[1],x=Object(c.useState)(""),g=Object(i.a)(x,2),v=g[0],y=g[1],N=Object(c.useState)(!1),w=Object(i.a)(N,2),S=w[0],C=w[1],A=Object(c.useState)(!1),k=Object(i.a)(A,2),M=k[0],E=k[1],D=Object(c.useState)(""),P=Object(i.a)(D,2),T=P[0],F=P[1],_=Object(c.useState)(!1),L=Object(i.a)(_,2),I=L[0],R=L[1],z=Object(c.useState)(""),W=Object(i.a)(z,2),J=W[0],q=W[1],H=Object(c.useState)(""),U=Object(i.a)(H,2),Y=U[0],$=U[1],V=Object(c.useState)(""),B=Object(i.a)(V,2),G=B[0],X=B[1],Z=Object(c.useState)([]),K=Object(i.a)(Z,2),Q=K[0],ee=K[1],te=Object(c.useState)(!1),ne=Object(i.a)(te,2),ce=ne[0],se=ne[1],ae=Object(c.useState)(!1),re=Object(i.a)(ae,2),ie=re[0],le=re[1];return Object(c.useEffect)((function(){}),[]),Object(f.jsx)("div",{children:Object(f.jsxs)("div",{className:"row",children:[Object(f.jsx)("div",{className:"col-0 col-md-3 col-xl-4"}),Object(f.jsx)("div",{className:"col-12 col-md-6 col-xl-4 mt-5 px-0",style:{border:"1px solid rgb(224, 224, 224)"},children:Object(f.jsxs)("div",{children:[Object(f.jsx)("form",{onSubmit:function(t){t.preventDefault();var n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:s,password:o}),credentials:"include"};h(!0),y(!1),fetch("".concat(p,"/api/auth/login"),n).then((function(e){return console.log(e),e})).then((function(e){return e.json()})).then((function(t){if(!t.success)throw new Error(t.message);m.a.set("loggedIn",!0),e({loggedIn:!0})})).catch((function(e){console.log(e),h(!1),y(e.message)}))},children:Object(f.jsxs)("div",{style:{margin:20},children:[Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"email",className:"form-label",children:"Email"}),Object(f.jsx)("input",{className:"form-control",type:"email",name:"email",id:"email",onChange:function(e){return a(e.target.value)},required:!0})]}),Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"password",className:"form-label",children:"Password"}),Object(f.jsx)("input",{className:"form-control",type:"password",name:"password",id:"password",onChange:function(e){return j(e.target.value)},required:!0})]}),v&&Object(f.jsx)("div",{className:"alert alert-danger  show mt-3",role:"alert",children:v}),u?Object(f.jsxs)("button",{className:"btn btn-primary",type:"submit",style:{width:"100%"},disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:"Loading..."})]}):Object(f.jsx)("button",{className:"btn btn-primary",type:"submit",style:{width:"100%"},children:"Login"})]})}),Object(f.jsxs)("div",{className:"px-3",style:{background:"rgb(238, 238, 238)"},children:[Object(f.jsx)("div",{className:"mt-4",style:{display:"flex",justifyContent:"flex-end",alignItems:"center",paddingRight:15,height:50},children:Object(f.jsx)("p",{style:{color:"rgb(88, 88, 88)",textDecoration:"underline"},onClick:function(){return C(!0)},children:"forgot password?"})}),S&&Object(f.jsxs)("div",{style:{padding:10},children:[Object(f.jsx)("p",{children:"Type email in the field above then submit. We will send reset password code to your email."}),T&&Object(f.jsx)("div",{className:"alert alert-danger  show mt-3",role:"alert",children:T}),I&&Object(f.jsx)("div",{className:"alert alert-success  show mt-3",role:"alert",children:"Reset password code has been sent to your email. Use that code to reset password."}),M?Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsxs)("button",{className:"btn btn-warning",type:"button",disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:" send code"})]})}):Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsx)("button",{className:"btn btn-warning",type:"button",onClick:function(){return function(){if(s){var e={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:s})};F(""),E(!0),R(!1),fetch("".concat(p,"/api/auth/requestresetpasswordcode"),e).then((function(e){return e.json()})).then((function(e){if(!e.success)throw new Error(e.message);F(""),E(!1),R(!0)})).catch((function(e){console.log(e),F(e.message),E(!1)}))}else F("Require your login email.")}()},children:"send code"})}),I&&Object(f.jsx)("div",{children:Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=function(e){var t=[];e.length<8?t.push("Password length must be atleast 8 characters."):e.length>20&&t.push("Password length must not exceed 20 characters.");var n=/(?=.*[a-z])/;return n.test(e)||t.push("Password must contain atleast 1 lowercase alphabetical character"),(n=/(?=.*[A-Z])/).test(e)||t.push("Password must contain at least 1 uppercase alphabetical character"),(n=/(?=.*[0-9])/).test(e)||t.push("Password must contain at least 1 numeric character"),t}(J);if(J!==Y&&t.push("Passwords do not match."),t.length)ee(t);else{var n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({pwd:J,pwdConfirm:Y,code:G})};ee([]),se(!0),le(!1),fetch("".concat(p,"/api/auth/resetpasswordbycode"),n).then((function(e){return e.json()})).then((function(e){if(console.log(e),!e.success)return Array.isArray(e.message)?ee(e.message):ee([e.message]),se(!1),void le(!1);ee([]),se(!1),le(!0)})).catch((function(e){console.log(e),ee([e.message]),se(!1),le(!1)}))}},children:[Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"pwd1",className:"form-label",children:"new password"}),Object(f.jsx)("input",{className:"form-control",type:"password",name:"pwd1",id:"pwd1",onChange:function(e){return q(e.target.value)},required:!0})]}),Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"pwd2",className:"form-label",children:"confirm password"}),Object(f.jsx)("input",{className:"form-control",type:"password",name:"pwd2",id:"pwd2",onChange:function(e){return $(e.target.value)},required:!0})]}),Object(f.jsxs)("div",{className:"mb-3",children:[Object(f.jsx)("label",{htmlFor:"code",className:"form-label",children:"code"}),Object(f.jsx)("input",{className:"form-control",type:"text",name:"code",id:"code",onChange:function(e){return X(e.target.value)},required:!0})]}),Q&&Q.map((function(e,t){return Object(f.jsx)("div",{className:"alert alert-danger  show mt-3",role:"alert",children:e},t)})),ie&&Object(f.jsx)("div",{className:"alert alert-success  show mt-3",role:"alert",children:"Successful. You can now login with the new password."}),ce?Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsxs)("button",{className:"btn btn-primary",type:"button",disabled:!0,children:[Object(f.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(f.jsx)("span",{className:"sr-only",children:" change password"})]})}):Object(f.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:Object(f.jsx)("button",{className:"btn btn-primary",type:"submit",children:"change password"})})]})})]})]})]})})]})})};var K=function(){return Object(f.jsx)("div",{children:Object(f.jsx)(E.EatLoading,{size:"40"})})};var Q=function(){var e=Object(c.useState)(null),t=Object(i.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(!0),r=Object(i.a)(a,2),o=r[0],j=r[1];return Object(c.useEffect)((function(){m.a.get("loggedIn")&&s({loggedIn:!0}),j(!1)}),[]),Object(f.jsx)(O.Provider,{value:{user:n,setUser:s},children:Object(f.jsx)("div",{children:Object(f.jsx)(l.a,{basename:"admin",children:o?Object(f.jsx)(K,{}):n?Object(f.jsx)(X,{}):Object(f.jsx)(Z,{})})})})};r.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(Q,{})}),document.getElementById("root"))}},[[93,1,2]]]);
//# sourceMappingURL=main.3675132e.chunk.js.map