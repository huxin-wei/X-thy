(this["webpackJsonpmusic-teacher-react"]=this["webpackJsonpmusic-teacher-react"]||[]).push([[0],{45:function(e,t,n){},93:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),s=n(30),i=n.n(s),r=n(3),l=(n(45),n(11)),o=n(6),j=n(20),d=n(32),b=n(33),u=n(34),h=n(12),m=n.n(h),O=Object(c.createContext)({}),p=n(1);var x=function(){var e=Object(c.useContext)(O).setUser,t=25;return Object(p.jsxs)("div",{className:"sidebar-wrapper",children:[Object(p.jsx)("div",{className:"sidebar-upper-wrapper",children:Object(p.jsxs)("ul",{children:[Object(p.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"calendar",children:Object(p.jsxs)(l.b,{activeClassName:"sidebar-link--active",className:"sidebar-link",to:"/calendar",children:[Object(p.jsx)(d.a,{size:t}),Object(p.jsx)("p",{children:"Calendar"})]})}),Object(p.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"manage guitar lessons",children:Object(p.jsxs)(l.b,{activeClassName:"sidebar-link--active",className:"sidebar-link",to:"/lesson",children:[Object(p.jsx)(j.b,{size:t}),Object(p.jsx)("p",{children:"Lesson"})]})}),Object(p.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"manage my availability",children:Object(p.jsxs)(l.b,{activeClassName:"sidebar-link--active",className:"sidebar-link",to:"/availability",children:[Object(p.jsx)(j.c,{size:t}),Object(p.jsx)("p",{children:"Availability"})]})}),Object(p.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"book an appointment",children:Object(p.jsxs)(l.b,{activeClassName:"sidebar-link--active",className:"sidebar-link",to:"/booking",children:[Object(p.jsx)(j.a,{size:t}),Object(p.jsx)("p",{children:"Book appointment"})]})}),Object(p.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"upload files",children:Object(p.jsxs)(l.b,{activeClassName:"sidebar-link--active",className:"sidebar-link",to:"/upload",children:[Object(p.jsx)(b.a,{size:t}),Object(p.jsx)("p",{children:"Upload"})]})})]})}),Object(p.jsx)("div",{className:"sidebar-bottom-wrapper",children:Object(p.jsx)("ul",{children:Object(p.jsx)("li",{"data-toggle":"tooltip","data-placement":"right",title:"log out",children:Object(p.jsxs)(l.b,{className:"sidebar-link",to:"/",onClick:function(){fetch("".concat("http://localhost:3001","/api/auth/logout"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(t){if(!t.success)throw new Error(t.message);m.a.remove("loggedIn"),m.a.remove("email"),e(null)})).catch((function(e){console.log(e.message)}))},children:[Object(p.jsx)(u.a,{size:t}),Object(p.jsx)("p",{children:"Logout"})]})})})})]})},f="";var g=function(e){var t=Object(c.useState)(""),n=Object(r.a)(t,2),a=n[0],s=n[1],i=Object(c.useState)(""),l=Object(r.a)(i,2),o=l[0],j=l[1],d=Object(c.useState)(""),b=Object(r.a)(d,2),u=b[0],h=b[1],m=Object(c.useState)(""),O=Object(r.a)(m,2),x=O[0],g=O[1],v=Object(c.useState)(!1),y=Object(r.a)(v,2),N=y[0],S=y[1],w=Object(c.useState)(""),M=Object(r.a)(w,2),C=M[0],k=M[1],A=Object(c.useRef)(!0);return Object(c.useEffect)((function(){return function(){A.current=!1}}),[]),console.log("Create lesson form re render"),Object(p.jsx)("div",{children:Object(p.jsx)("div",{className:"mt-3 mb-3",children:Object(p.jsxs)("form",{onSubmit:function(t){if(t.preventDefault(),!A.current)return null;S(!0),k("");var n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({lesson:a,description:o,price30m:u,price60m:x}),credentials:"include"};fetch("".concat(f,"/api/lesson/add"),n).then((function(e){if(!e.ok)throw{message:"".concat(e.status,": Cannot connect to the server.")};return e})).then((function(e){return e.json()})).then((function(t){if(!A.current)return null;if(!t.success)throw new Error(t.message);e.handleClose(),e.signalAddSuccess()})).catch((function(e){if(!A.current)return null;console.log(e),k(e.message),S(!1)}))},className:"form-default-box mw-600",children:[Object(p.jsxs)("div",{className:"mb-3",children:[Object(p.jsxs)("label",{htmlFor:"lessonName",className:"form-label",children:[Object(p.jsx)("b",{children:"Lesson name"})," (",70-a.length," chars left)"]}),Object(p.jsx)("input",{onChange:function(e){var t=e.target.value;t.length<=70?s(e.target.value):e.target.value=t},value:a,type:"text",className:"form-control",id:"lessonName"})]}),Object(p.jsxs)("div",{className:"mb-3",children:[Object(p.jsxs)("label",{htmlFor:"description",className:"form-label",children:[Object(p.jsx)("b",{children:"Description"})," (",500-o.length," chars left)"]}),Object(p.jsx)("textarea",{onChange:function(e){e.target.style.height="",e.target.style.height=Math.min(e.target.scrollHeight,300)+"px";var t=e.target.value;t.length<=500&&j(t),t.length>500&&(e.target.value=o)},className:"form-control",id:"description",rows:5,maxLength:300,wrap:"soft"})]}),Object(p.jsx)("div",{className:"mb-3",children:Object(p.jsx)("b",{children:"Price rates"})}),Object(p.jsxs)("div",{className:"row g-2 mb-2",children:[Object(p.jsx)("div",{className:"col-auto",children:Object(p.jsx)("label",{htmlFor:"price-30m",className:"form-label",children:"30 minutes"})}),Object(p.jsx)("div",{className:"col-3",children:Object(p.jsx)("input",{type:"text",onChange:function(e){var t=e.target.value;/^\d+\.{0,1}\d{0,2}$/.test(t)||""===t?h(t):e.target.value=""},value:u,maxLength:"10",className:"form-control",id:"price-30m"})}),Object(p.jsx)("div",{className:"col-auto",children:"$"})]}),Object(p.jsxs)("div",{className:"row g-2 mb-2 ",children:[Object(p.jsx)("div",{className:"col-auto ",children:Object(p.jsx)("label",{htmlFor:"price-60m",className:"form-label align-middle",children:"60 minutes"})}),Object(p.jsx)("div",{className:"col-3",children:Object(p.jsx)("input",{type:"text",onChange:function(e){var t=e.target.value;/^\d+\.{0,1}\d{0,2}$/.test(t)||""===t?g(t):e.target.value=""},value:x,maxLength:"10",className:"form-control",id:"price-60m"})}),Object(p.jsx)("div",{className:"col-auto",children:"$"})]}),C&&Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:C}),Object(p.jsxs)("div",{style:{width:"100%",height:30,margin:"25px auto 10px auto"},children:[Object(p.jsx)("button",{type:"button",className:"btn btn-danger d-inline-block float-start",onClick:function(){return e.handleClose()},children:"Cancel"}),N?Object(p.jsxs)("button",{className:"btn btn-primary float-end",type:"button",disabled:!0,children:[Object(p.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(p.jsx)("span",{className:"sr-only",children:"Loading..."})]}):Object(p.jsx)("button",{type:"submit",className:"btn btn-primary d-inline-block float-end",children:"Add"})]})]})})})},v=n(18);var y=function(e){var t=e.lessonId,n=e.lessonName,a=e.description,s=e.price30m,i=e.price60m,l=e.removeLesson,o=Object(c.useState)(""),j=Object(r.a)(o,2),d=j[0],b=j[1],u=Object(c.useState)(!1),h=Object(r.a)(u,2),m=h[0],O=h[1],x=Object(c.useRef)(!0);return Object(c.useEffect)((function(){return function(){x.current=!1}}),[]),Object(p.jsx)("div",{className:"mb-2 pd-4",children:Object(p.jsxs)("div",{className:"default-wrapper mw-600",children:[Object(p.jsx)("h1",{className:"web-main-color",children:n}),Object(p.jsxs)("div",{className:"ms-3 mb-2",children:[Object(p.jsx)("p",{className:"text-secondary",children:a}),Object(p.jsx)("p",{className:"mb-1 text-secondary",children:Object(p.jsx)("b",{children:"Fee rates"})}),Object(p.jsxs)("p",{className:"mb-1 text-secondary",children:["30 minutes: ",Object(p.jsxs)("b",{children:["$",s]})]}),Object(p.jsxs)("p",{className:"mb-1 text-secondary",children:["60 minutes: ",Object(p.jsxs)("b",{children:["$",i]})]})]}),d&&Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:d}),Object(p.jsx)("div",{style:{height:30},children:m?Object(p.jsxs)("button",{className:"btn btn-danger py-1 float-end",type:"button",disabled:!0,children:[Object(p.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(p.jsx)("span",{className:"sr-only",children:"Deleting..."})]}):Object(p.jsxs)("button",{onClick:function(){O(!0),b("");fetch("".concat(f,"/api/lesson/delete/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(!e.success)throw new Error(e.message);if(!x.current)return null;O(!1),b(""),l(t)})).catch((function(e){if(!x.current)return null;O(!1),b(e.message)}))},type:"button",title:"delete",className:"btn btn-danger py-1 float-end",children:[Object(p.jsx)(v.a,{size:20}),Object(p.jsx)("span",{className:"align-middle button-text",style:{fontSize:12},children:"DELETE"})]})})]})})};var N=function(){var e=Object(c.useState)([]),t=Object(r.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(!1),i=Object(r.a)(s,2),l=i[0],o=i[1],j=Object(c.useState)(!1),d=Object(r.a)(j,2),b=d[0],u=d[1],h=Object(c.useState)(0),m=Object(r.a)(h,2),O=m[0],x=m[1],v=Object(c.useState)(!1),N=Object(r.a)(v,2),S=N[0],w=N[1],M=Object(c.useState)(""),C=Object(r.a)(M,2),k=C[0],A=C[1],D=Object(c.useRef)(!0),E=function(e){a(n.filter((function(t){return t.lesson_id!=e})))};return Object(c.useEffect)((function(){return function(){D.current=!1}}),[]),Object(c.useEffect)((function(){if(!D.current)return null;w(!0),A("");fetch("".concat(f,"/api/lesson/active"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(!e.success)throw new Error(e.message);if(!e.lessons.length)throw new Error("There is no lesson. Please consider creating one.");if(!D.current)return null;a(e.lessons),w(!1),A("")})).catch((function(e){if(!D.current)return null;console.log(e.message),w(!1),A(e.message)}))}),[O]),Object(p.jsxs)("div",{className:"pt-3",children:[b&&Object(p.jsx)("div",{className:"alert alert-success",role:"alert",children:"Successfully added."}),l?Object(p.jsx)(g,{handleClose:function(){return o(!1)},signalAddSuccess:function(){u(!0),x(O+1),setTimeout((function(){u(!1)}),2e3)}}):Object(p.jsx)("div",{style:{textAlign:"center"},children:Object(p.jsx)("button",{className:"btn btn-primary",onClick:function(){return o(!0)},children:"Add Lesson"})}),Object(p.jsxs)("div",{className:"pt-3",style:{textAlign:"center"},children:[S?Object(p.jsx)("div",{className:"text-center",children:Object(p.jsx)("div",{className:"spinner-border",role:"status",style:{color:"orange"}})}):k&&Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:k}),n.map((function(e){return Object(p.jsx)(y,{removeLesson:E,lessonId:e.lesson_id,lessonName:e.lesson_name,description:e.description,price30m:e.price_30m,price60m:e.price_60m},e.lesson_id)}))]})]})},S=n(14),w=n(25),M=[{value:0,month:"JAN"},{value:1,month:"FEB"},{value:2,month:"MAR"},{value:3,month:"APR"},{value:4,month:"MAY"},{value:5,month:"JUN"},{value:6,month:"JUL"},{value:7,month:"AUG"},{value:8,month:"SEP"},{value:9,month:"OCT"},{value:10,month:"NOV"},{value:11,month:"DEC"}],C=["Sun","Mon","Tu","Wed","Th","Fri","Sat"];var k=function(e){var t=Object(c.useState)(e.date),n=Object(r.a)(t,2),a=n[0],s=n[1],i=Object(c.useState)(e.month),l=Object(r.a)(i,2),o=l[0],j=l[1],d=Object(c.useState)(e.year),b=Object(r.a)(d,2),u=b[0],h=b[1],m=Object(c.useState)(e.month),O=Object(r.a)(m,2),x=O[0],f=O[1],g=Object(c.useState)(e.year),v=Object(r.a)(g,2),y=v[0],N=v[1],S=Object(c.useState)([]),k=Object(r.a)(S,2),A=k[0],D=k[1],E=e.onDateChange;Object(c.useEffect)((function(){P()}),[o,u]);var P=function(){for(var e=[],t=new Date,n=new Date(u,o,1).getDay(),c=new Date(u,o+1,0).getDate()+n,a=1-n,s=0;s<c;s++){var i=new Date(u,o,a),r={id:a,upComming:a>0&&(_(i,t)||T(i,t))};e.push(r),a++}D(e)},T=function(e,t){return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},_=function(e,t){return e>t},F=function(e){j(parseInt(e.target.id)),console.log("month",e.target.id)},L=function(e){f(o),N(u),s(parseInt(e.target.id)),E(parseInt(e.target.id),o,u),console.log("var:",parseInt(e.target.id),o,u)};return Object(p.jsx)("div",{children:Object(p.jsxs)("div",{className:"calendar-picker",children:[Object(p.jsx)("div",{style:{display:"flex",margin:"10px 3px",borderBottom:"2px solid #f2f2f2"},children:Object(p.jsx)("h3",{style:{margin:"auto",fontSize:25},children:"".concat(a," ").concat(M[x].month," ").concat(y)})}),Object(p.jsxs)("div",{className:"year-spinner",children:[Object(p.jsx)("button",{onClick:function(){u>1970&&h(u-1)},className:"float-start",children:Object(p.jsx)(w.a,{size:25})}),Object(p.jsx)("span",{style:{fontSize:20},children:u}),Object(p.jsx)("button",{onClick:function(){h(u+1)},className:"float-end",children:Object(p.jsx)(w.b,{size:25})})]}),Object(p.jsx)("div",{className:"month-picker py-2",children:Object(p.jsx)("div",{className:"month-grid",children:M.map((function(e){return Object(p.jsx)("div",{className:"".concat(parseInt(e.value)==parseInt(o)?"month-item-active":""," month-item "),children:Object(p.jsx)("button",{id:e.value,onClick:F,children:e.month})},e.value)}))})}),Object(p.jsxs)("div",{className:"date-grid py-2",children:[C.map((function(e,t){return Object(p.jsx)("div",{className:"date-item date-item-header",children:Object(p.jsx)("div",{style:{margin:"auto"},children:e})},t)})),A.map((function(e){var t=e.upComming?"date-item-upcomming":"",n=e.id==a&&o==x&&u==y?"date-item-active":"";return Object(p.jsx)("div",{className:"date-item ".concat(t," ").concat(n),children:Object(p.jsx)("button",{disabled:!e.upComming,onClick:L,id:e.id,children:Object(p.jsx)("div",{id:e.id,children:Object(p.jsx)("p",{id:e.id,children:e.id>0&&e.id})})})},e.id)}))]})]})})};var A=function(e){var t=Object(c.useState)([]),n=Object(r.a)(t,2),a=n[0],s=n[1],i=Object(c.useState)([]),l=Object(r.a)(i,2),o=l[0],j=l[1],d=Object(c.useState)(!1),b=Object(r.a)(d,2),u=b[0],h=b[1];return Object(c.useEffect)((function(){h(!0);console.log(e.fullDate);var t=new Date(e.fullDate),n=t.getDay();t=t.toUTCString(),fetch("".concat(f,"/api/availability/offertime?day=").concat(n,"&duration=").concat(e.duration,"&utcDate=").concat(t),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){if(!e.success)throw console.log(e),new Error(e.message);if(0===e.times.length)throw new Error("I'm not available today. Check another day or decrease session time.");console.log(e),h(!1),s([]),j(e.times)})).catch((function(e){j([]),h(!1),Array.isArray(e)?(s(e),console.log("it is array")):(s([e.message]),console.log("err is not array")),console.log(e)}))}),[e.fullDate,e.duration,e.dummy]),Object(p.jsxs)("div",{children:[u?Object(p.jsx)("div",{style:{margin:"auto",textAlign:"center"},children:Object(p.jsx)("div",{className:"spinner-border text-warning",role:"status"})}):Object(p.jsx)("div",{children:o.map((function(t,n){var c=function(e){var t=Math.floor(e/60),n=t>=12?"PM":"AM",c=(e%60+"0").substring(0,2);return"".concat((t+11)%12+1,":").concat(c," ").concat(n)}(t);return Object(p.jsx)("button",{type:"button",className:"btn btn-primary mx-2 my-2",style:{width:100},onClick:function(t){e.onTimeSelected(c)},children:c},n)}))}),a.map((function(e,t){return Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:e},t)}))]})},D=n(19);var E=function(e){var t=Object(c.useState)([]),n=Object(r.a)(t,2),a=n[0],s=n[1],i=Object(c.useState)(null),l=Object(r.a)(i,2),o=l[0],j=l[1],d=Object(c.useRef)(!0),b=Object(c.useState)(!1),u=Object(r.a)(b,2),h=u[0],m=u[1],O=Object(c.useState)(""),x=Object(r.a)(O,2),g=x[0],v=x[1];return Object(c.useEffect)((function(){if(!d.current)return null;m(!0),v("");return fetch("".concat(f,"/api/lesson/active"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){if(!e.success)throw new Error(e.message);if(!e.lessons.length)throw new Error("We are sorry. No lesson is available now.");if(!d.current)return null;s(e.lessons),m(!1),v("")})).catch((function(e){if(!d.current)return null;console.log(e.message),m(!1),v(e.message)})),function(){d.current=!1}}),[]),Object(p.jsxs)("div",{children:[h?Object(p.jsx)(D.EatLoading,{color:"orange"}):g&&Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:g}),Object(p.jsx)("div",{className:"class-offer-flex",children:a.map((function(t){return Object(p.jsxs)("div",{className:"class-offer my-2 ".concat(o==t.lesson_id?"class-offer-active":"class-offer-inactive"),onClick:function(){j(t.lesson_id),e.selectLesson({lessonId:t.lesson_id,lessonName:t.lesson_name,price30m:t.price_30m,price60m:t.price_60m})},children:[Object(p.jsx)("h3",{children:t.lesson_name}),Object(p.jsxs)("p",{children:["30 minutes: $",t.price_30m]}),Object(p.jsxs)("p",{children:["60 minutes: $",t.price_60m]})]},t.lesson_id)}))})]})},P=new Date,T=P.getDate(),_=P.getMonth()+1,F=P.getFullYear(),L="".concat(F,"-").concat(_,"-").concat(T);var I=function(e){var t=Object(c.useState)(""),n=Object(r.a)(t,2),a=n[0],s=n[1],i=Object(c.useState)(""),l=Object(r.a)(i,2),o=l[0],j=l[1],d=Object(c.useState)(""),b=Object(r.a)(d,2),u=b[0],h=b[1],m=Object(c.useState)(""),O=Object(r.a)(m,2),x=O[0],g=O[1],v=Object(c.useState)(60),y=Object(r.a)(v,2),N=y[0],w=y[1],M=Object(c.useState)(L),C=Object(r.a)(M,2),D=C[0],P=C[1],I=Object(c.useState)(null),z=Object(r.a)(I,2),U=z[0],H=z[1],J=Object(c.useState)(""),R=Object(r.a)(J,2),Y=R[0],W=R[1],$=Object(c.useState)([]),B=Object(r.a)($,2),V=B[0],G=B[1],q=Object(c.useState)(!1),X=Object(r.a)(q,2),K=X[0],Q=X[1],Z=Object(c.useState)(!1),ee=Object(r.a)(Z,2),te=ee[0],ne=ee[1],ce=Object(c.useState)(0),ae=Object(r.a)(ce,2),se=ae[0],ie=ae[1],re=Object(c.useRef)(!0);Object(c.useEffect)((function(){return function(){re.current=!1}}),[]),Object(c.useEffect)((function(){W("")}),[D,N]);var le=function(){var e=[].concat(Object(S.a)(U?[]:["Lesson is missing. Please select a lesson"]),Object(S.a)(D?[]:["Date is missing. Please select date"]),Object(S.a)(Y?[]:["Time is missing. Please select time."]),Object(S.a)(a?[]:["Name is required."]),Object(S.a)(o?[]:["Email address is required."]),Object(S.a)(N>0&&N%30==0?[]:["Select session duration."]));if(e.length)return G(e);var t=new Date("".concat(D," ").concat(Y));console.log("date without turning to utc: ",t),console.log("date turning to utc first:",t.toUTCString());var n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({name:a,email:o,phone:u,note:x,date:new Date("".concat(D," ").concat(Y)),duration:N,lessonId:U.lessonId})};console.log("the date",""),Q(!0),G([]),fetch("".concat(f,"/api/booking"),n).then((function(e){return e.json()})).then((function(e){if(!re.current)return null;if(!e.success)throw new Error(e.message);console.log("hello"),G([]),Q(!1),W(""),ie(se+1),ne(!0),setTimeout((function(){if(!re.current)return null;ne(!1)}),7e3)})).catch((function(e){if(!re.current)return null;Array.isArray(e)?(console.log("1",e),G(e)):(console.log("2",e),G([e.message])),Q(!1)}))};return Object(p.jsxs)("div",{style:{maxWidth:600,margin:"auto",padding:"40px 0px 150px 0px"},children:[Object(p.jsxs)("section",{children:[Object(p.jsx)("div",{className:"guide-banner mb-4",children:Object(p.jsx)("h3",{children:"Select class"})}),Object(p.jsx)(E,{selectLesson:H})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)("div",{className:"guide-banner my-4",children:Object(p.jsx)("h3",{children:"Select session duration"})}),Object(p.jsx)("div",{children:Object(p.jsx)("div",{style:{width:200,margin:"20px auto"},children:Object(p.jsxs)("select",{className:"form-select",defaultValue:N,"aria-label":"Default select example",onChange:function(e){w(e.target.value)},children:[Object(p.jsx)("option",{value:"30",children:"30 minutes"}),Object(p.jsx)("option",{value:"60",children:"1 hour"}),Object(p.jsx)("option",{value:"90",children:"1 hour 30 minutes"}),Object(p.jsx)("option",{value:"120",children:"2 hours"}),Object(p.jsx)("option",{value:"150",children:"2 hours 30 minutes"}),Object(p.jsx)("option",{value:"180",children:"3 hours"}),Object(p.jsx)("option",{value:"210",children:"3 hours 30 minutes"}),Object(p.jsx)("option",{value:"240",children:"4 hours"})]})})})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)("div",{className:"guide-banner my-4",children:Object(p.jsx)("h3",{children:"Select date"})}),Object(p.jsx)(k,{date:T,month:_-1,year:F,onDateChange:function(e,t,n){P(n+"-"+(t+1)+"-"+e)}})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)("div",{className:"guide-banner my-4",children:Object(p.jsx)("h3",{children:"Select time"})}),Object(p.jsx)(A,{duration:N,fullDate:D,onTimeSelected:W,dummy:se})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)("div",{className:"guide-banner my-4",children:Object(p.jsx)("h3",{children:"Your information"})}),Object(p.jsxs)("form",{className:"form-default-box",children:[Object(p.jsxs)("div",{className:"mb-3",children:[Object(p.jsxs)("label",{htmlFor:"name",className:"form-label",children:[Object(p.jsx)("b",{children:"Name"})," "]}),Object(p.jsx)("input",{type:"text",length:50,className:"form-control",id:"name",required:!0,onChange:function(e){s(e.target.value)}})]}),Object(p.jsxs)("div",{className:"mb-3",children:[Object(p.jsx)("label",{htmlFor:"email",className:"form-label",children:Object(p.jsx)("b",{children:"Email"})}),Object(p.jsx)("input",{type:"email",length:50,className:"form-control",id:"email",required:!0,onChange:function(e){j(e.target.value)}})]}),Object(p.jsxs)("div",{className:"mb-3",children:[Object(p.jsx)("label",{htmlFor:"phone",className:"form-label",children:Object(p.jsx)("b",{children:"Phone"})}),Object(p.jsx)("input",{type:"tel",length:20,className:"form-control",id:"phone",onChange:function(e){h(e.target.value)}})]}),Object(p.jsxs)("div",{className:"mb-3",children:[Object(p.jsx)("label",{htmlFor:"note",className:"form-label",children:Object(p.jsx)("b",{children:"Note"})}),Object(p.jsx)("textarea",{className:"form-control",id:"description",rows:5,wrap:"soft",onChange:function(e){g(e.target.value)}})]})]})]}),Object(p.jsxs)("section",{children:[Object(p.jsx)("div",{className:"guide-banner my-4",children:Object(p.jsx)("h3",{children:"Confirm details & Book appointment"})}),Object(p.jsx)("table",{className:"table mb-4",style:{margin:"auto",maxWidth:600},children:Object(p.jsxs)("tbody",{children:[Object(p.jsx)("tr",{className:"table-primary",children:Object(p.jsx)("td",{colSpan:"2",children:Object(p.jsx)("b",{children:"Your information"})})}),Object(p.jsxs)("tr",{className:"table-light",children:[Object(p.jsx)("td",{className:"booking-info-tag",children:"Name"}),Object(p.jsx)("td",{children:a})]}),Object(p.jsxs)("tr",{className:"table-light",children:[Object(p.jsx)("td",{className:"booking-info-tag",children:"Email"}),Object(p.jsx)("td",{children:o})]}),Object(p.jsxs)("tr",{className:"table-light",children:[Object(p.jsx)("td",{className:"booking-info-tag",children:"Phone"}),Object(p.jsx)("td",{children:u})]}),Object(p.jsxs)("tr",{className:"table-light",children:[Object(p.jsx)("td",{className:"booking-info-tag",style:{verticalAlign:"top"},children:"Note"}),Object(p.jsx)("td",{children:x})]}),Object(p.jsx)("tr",{className:"table-primary",children:Object(p.jsx)("td",{colSpan:"2",children:Object(p.jsx)("b",{children:"Appointment information"})})}),Object(p.jsxs)("tr",{className:"table-light",children:[Object(p.jsx)("td",{className:"booking-info-tag",children:"Class"}),Object(p.jsx)("td",{children:U&&U.lessonName})]}),Object(p.jsxs)("tr",{className:"table-light",children:[Object(p.jsx)("td",{className:"booking-info-tag",children:"Class ID"}),Object(p.jsx)("td",{children:U&&U.lessonId})]}),Object(p.jsxs)("tr",{className:"table-light",children:[Object(p.jsx)("td",{className:"booking-info-tag",children:"Date"}),Object(p.jsx)("td",{children:D})]}),Object(p.jsxs)("tr",{className:"table-light",children:[Object(p.jsx)("td",{className:"booking-info-tag",children:"Time"}),Object(p.jsx)("td",{children:Y})]}),Object(p.jsxs)("tr",{className:"table-light",children:[Object(p.jsx)("td",{className:"booking-info-tag",children:"Duration"}),Object(p.jsxs)("td",{children:[N," minutes"]})]}),Object(p.jsxs)("tr",{className:"table-light",children:[Object(p.jsx)("td",{className:"booking-info-tag",children:"Fee"}),Object(p.jsxs)("td",{children:["$",U&&U.price60m*Math.floor(N/60)+U.price30m*(N%60==30?1:0)," (pay at the study date)"]})]})]})}),V.length>0&&Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:Object(p.jsx)("ul",{children:V.map((function(e,t){return Object(p.jsx)("li",{children:e},t)}))})}),te&&Object(p.jsxs)("div",{className:"alert alert-success",role:"alert",children:[Object(p.jsx)("p",{children:"Successfully booked. Booking details will be sent to your email address."}),Object(p.jsx)("p",{children:"You can continue booking on this page."})]}),K?Object(p.jsxs)("button",{className:"btn btn-primary float-end",type:"button",disabled:!0,children:[Object(p.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(p.jsx)("span",{className:"sr-only",children:"Loading..."})]}):Object(p.jsx)("button",{className:"btn btn-primary d-inline-block float-end",onClick:function(){le()},children:"Book now"})]})]})},z=n(38);var U=function(e){var t=Object(c.useState)(""),n=Object(r.a)(t,2),a=(n[0],n[1],Object(c.useState)("")),s=Object(r.a)(a,2),i=(s[0],s[1],Object(c.useState)([{id:0,day:"Sun",isChecked:!1},{id:1,day:"Mon",isChecked:!1},{id:2,day:"Tu",isChecked:!1},{id:3,day:"Wed",isChecked:!1},{id:4,day:"Th",isChecked:!1},{id:5,day:"Fri",isChecked:!1},{id:6,day:"Sat",isChecked:!1},{id:7,day:"Everyday",isChecked:!1}])),l=Object(r.a)(i,2),o=l[0],j=l[1],d=Object(c.useState)(!1),b=Object(r.a)(d,2),u=b[0],h=b[1],m=Object(c.useState)([]),O=Object(r.a)(m,2),x=O[0],g=O[1],v=Object(c.useState)(""),y=Object(r.a)(v,2),N=y[0],S=(y[1],Object(c.useState)("")),w=Object(r.a)(S,2),M=w[0],C=w[1],k=Object(c.useState)(0),A=Object(r.a)(k,2),D=A[0],E=A[1],P=Object(c.useState)(0),T=Object(r.a)(P,2),_=T[0],F=T[1],L=Object(c.useState)("AM"),I=Object(r.a)(L,2),U=I[0],H=I[1],J=Object(c.useState)(0),R=Object(r.a)(J,2),Y=R[0],W=R[1],$=Object(c.useState)(0),B=Object(r.a)($,2),V=B[0],G=B[1],q=Object(c.useState)("AM"),X=Object(r.a)(q,2),K=X[0],Q=X[1],Z=Object(c.useRef)(!0);Object(c.useEffect)((function(){return function(){Z.current=!1}}),[]),console.log("Create availability form re render");var ee=function(){var e="";return o.map((function(t){7!=t.id&&t.isChecked&&(e+=t.id)})),e},te=function(e){j(o.map((function(t){return 7==e.target.id?o.map((function(t){t.isChecked=e.target.checked})):e.target.id==t.id&&(t.isChecked=e.target.checked,o[7].isChecked=!1),Object(z.a)({},t)}))),console.log(o)};return Object(p.jsx)("div",{children:Object(p.jsx)("div",{className:"mt-3 mb-3",children:Object(p.jsxs)("form",{className:"form-default-box",onSubmit:function(t){t.preventDefault();var n=60*(1*D+("AM"===U?0:12))+1*_,c=(console.log(Y),console.log(V),console.log(K),1*Y==0&&1*V==0&&"AM"==K?(console.log("visit"),1440):60*(1*Y+("AM"===K?0:12))+1*V);if(n>=c)return console.log("timefrom",n),console.log("timeto",c),g(["Incorrect time."]);if(console.log("after"),!Z.current)return console.log("mountedRef false"),null;if(g([]),h(!0),console.log("1"),!ee())return C("At least one day must be selected."),void h(!1);C(""),console.log("2");var a={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({timeFrom:n,timeTo:c,days:ee()}),credentials:"include"};fetch("".concat(f,"/api/availability/"),a).then((function(e){if(401===e.status)throw new Error("Unauthorized.");return e})).then((function(e){return e.json()})).then((function(t){if(console.log("data: ",t),!Z.current)return null;if(console.log("yo"),!t.success)throw new Error(t.message);e.handleClose(),e.signalAddSuccess()})).catch((function(e){if(!Z.current)return null;Array.isArray(e)?(console.log("1",e),g(e)):(console.log("2",e),g([e.message])),h(!1)}))},style:{margin:"auto",maxWidth:320},children:[Object(p.jsx)("div",{className:"py-1",style:{textAlign:"center"},children:Object(p.jsx)("b",{children:"From"})}),Object(p.jsxs)("div",{style:{margin:"5px auto",width:"100%",textAlign:"center"},children:[Object(p.jsx)("div",{style:{display:"inline-block"},children:Object(p.jsxs)("select",{className:"form-select",defaultValue:D,name:"fromH",id:"fromH",onChange:function(e){E(e.target.value)},children:[Object(p.jsx)("option",{value:"0",children:"12"}),Object(p.jsx)("option",{value:"1",children:"01"}),Object(p.jsx)("option",{value:"2",children:"02"}),Object(p.jsx)("option",{value:"3",children:"03"}),Object(p.jsx)("option",{value:"4",children:"04"}),Object(p.jsx)("option",{value:"5",children:"05"}),Object(p.jsx)("option",{value:"6",children:"06"}),Object(p.jsx)("option",{value:"7",children:"07"}),Object(p.jsx)("option",{value:"8",children:"08"}),Object(p.jsx)("option",{value:"9",children:"09"}),Object(p.jsx)("option",{value:"10",children:"10"}),Object(p.jsx)("option",{value:"11",children:"11"})]})}),"\xa0",Object(p.jsx)("b",{children:":"}),"\xa0",Object(p.jsx)("div",{style:{display:"inline-block"},children:Object(p.jsxs)("select",{className:"form-select",defaultValue:_,name:"fromM",id:"fromM",onChange:function(e){F(e.target.value)},children:[Object(p.jsx)("option",{value:"0",children:"00"}),Object(p.jsx)("option",{value:"30",children:"30"})]})}),"\xa0",Object(p.jsx)("div",{style:{display:"inline-block"},children:Object(p.jsxs)("select",{className:"form-select",defaultValue:U,name:"fromAP",id:"fromAP",onChange:function(e){H(e.target.value)},children:[Object(p.jsx)("option",{value:"AM",children:"AM"}),Object(p.jsx)("option",{value:"PM",children:"PM"})]})})]}),Object(p.jsx)("div",{className:"py-1",style:{textAlign:"center"},children:Object(p.jsx)("b",{children:"To"})}),Object(p.jsxs)("div",{style:{margin:"5px auto",width:"100%",textAlign:"center"},children:[Object(p.jsx)("div",{style:{display:"inline-block"},children:Object(p.jsxs)("select",{className:"form-select",defaultValue:Y,name:"toH",id:"toH",onChange:function(e){W(e.target.value)},children:[Object(p.jsx)("option",{value:"0",children:"12"}),Object(p.jsx)("option",{value:"1",children:"01"}),Object(p.jsx)("option",{value:"2",children:"02"}),Object(p.jsx)("option",{value:"3",children:"03"}),Object(p.jsx)("option",{value:"4",children:"04"}),Object(p.jsx)("option",{value:"5",children:"05"}),Object(p.jsx)("option",{value:"6",children:"06"}),Object(p.jsx)("option",{value:"7",children:"07"}),Object(p.jsx)("option",{value:"8",children:"08"}),Object(p.jsx)("option",{value:"9",children:"09"}),Object(p.jsx)("option",{value:"10",children:"10"}),Object(p.jsx)("option",{value:"11",children:"11"})]})}),"\xa0",Object(p.jsx)("b",{children:":"}),"\xa0",Object(p.jsx)("div",{style:{display:"inline-block"},children:Object(p.jsxs)("select",{className:"form-select",defaultValue:V,name:"toM",id:"toM",onChange:function(e){G(e.target.value)},children:[Object(p.jsx)("option",{value:"0",children:"00"}),Object(p.jsx)("option",{value:"30",children:"30"})]})}),"\xa0",Object(p.jsx)("div",{style:{display:"inline-block"},children:Object(p.jsxs)("select",{className:"form-select",defaultValue:K,name:"toAP",id:"toAP",onChange:function(e){Q(e.target.value)},children:[Object(p.jsx)("option",{value:"AM",children:"AM"}),Object(p.jsx)("option",{value:"PM",children:"PM"})]})})]}),Object(p.jsx)("div",{className:"form-check",children:o.map((function(e){return Object(p.jsxs)("div",{children:[Object(p.jsx)("input",{className:"form-check-input",type:"checkbox",id:e.id,onChange:te,checked:e.isChecked}),Object(p.jsx)("label",{className:"form-check-label",htmlFor:e.id,children:e.day})]},e.id)}))}),N&&Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:N}),M&&Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:M}),x.map((function(e,t){return console.log(e),console.log("the error is: ".concat(t,": ").concat(e)),Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:e},t)})),Object(p.jsxs)("div",{style:{width:"100%",height:20,marginTop:20},children:[Object(p.jsx)("button",{type:"button",className:"btn btn-danger d-inline-block float-start",onClick:function(){return e.handleClose()},children:"Cancel"}),u?Object(p.jsxs)("button",{className:"btn btn-primary float-end",type:"button",disabled:!0,children:[Object(p.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(p.jsx)("span",{className:"sr-only",children:"Loading..."})]}):Object(p.jsx)("button",{type:"submit",className:"btn btn-primary d-inline-block float-end",children:"Add"})]})]})})})};var H=function(e){var t=e.availability,n=e.removeAvailability,a=Object(c.useState)(!1),s=Object(r.a)(a,2),i=s[0],l=s[1],o=Object(c.useState)(""),j=Object(r.a)(o,2),d=j[0],b=j[1],u=Object(c.useRef)(!0),h=["Sun","Mon","Tu","Wed","Th","Fri","Sat"],m=function(e){if(1440==e)return"12:00 AM";var t=Math.floor(e/60),n=t>=12?"PM":"AM",c=(e%60+"0").substring(0,2);return t="".concat((t+11)%12+1,":").concat(c," ").concat(n)},O=m(t.start_minute),x=m(t.end_minute);return Object(p.jsx)("div",{children:Object(p.jsx)("div",{className:"mb-2 pd-4 default-wrapper mw-400",children:Object(p.jsxs)("div",{className:"",children:[Object(p.jsxs)("div",{className:"mb-2",children:[function(){for(var e=[0,0,0,0,0,0,0],n=t.days,c=0;c<n.length;c++)e[n[c]]=1;return Object(p.jsx)("div",{style:{margin:"10px auto"},children:e.map((function(e,t){return Object(p.jsx)("div",{style:{display:"inline-block",textAlign:"center",minWidth:40,color:e?"orange":"#eee"},children:h[t]},t)}))})}(),Object(p.jsx)("p",{className:"mb-1 text-secondary",children:Object(p.jsx)("b",{children:O==x?"All day":"".concat(O," - ").concat(x)})})]}),d&&Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:d}),Object(p.jsx)("div",{style:{height:30},children:i?Object(p.jsxs)("button",{className:"btn btn-danger py-1 float-end",type:"button",disabled:!0,children:[Object(p.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(p.jsx)("span",{className:"sr-only",children:"Deleting..."})]}):Object(p.jsxs)("button",{onClick:function(){l(!0),b("");fetch("".concat(f,"/api/availability/delete/").concat(t.availability_id),{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(!e.success)throw new Error(e.message);if(!u.current)return null;l(!1),b(""),n(t.availability_id)})).catch((function(e){if(!u.current)return null;l(!1),b(e.message)}))},type:"button",title:"delete",className:"btn btn-danger py-1 float-end",children:[Object(p.jsx)(v.a,{size:20}),Object(p.jsx)("span",{className:"align-middle button-text",style:{fontSize:10},children:"DELETE"})]})})]})})})};var J=function(){var e=Object(c.useState)({success:!1}),t=Object(r.a)(e,2),n=(t[0],t[1],Object(c.useState)([])),a=Object(r.a)(n,2),s=a[0],i=a[1],l=Object(c.useRef)(!0),o=Object(c.useState)(!1),j=Object(r.a)(o,2),d=j[0],b=j[1],u=Object(c.useState)(!1),h=Object(r.a)(u,2),m=h[0],O=h[1],x=Object(c.useState)(0),g=Object(r.a)(x,2),v=g[0],y=g[1],N=Object(c.useState)(!1),S=Object(r.a)(N,2),w=S[0],M=S[1],C=Object(c.useState)(""),k=Object(r.a)(C,2),A=k[0],D=k[1];function E(e,t){return e.days<t.days?-1:e.days>t.days?1:0}Object(c.useEffect)((function(){return function(){l.current=!1}}),[]),Object(c.useEffect)((function(){if(!l.current)return null;M(!0),D("");fetch("".concat(f,"/api/availability/all"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){if(!l.current)return null;if(!e.success)throw new Error(e.message);e.data.sort(E),i(e.data),D(""),M(!1)})).catch((function(e){if(!l.current)return null;console.log(e.message),D(e.message),M(!1)}))}),[v]);var P=function(e){i(s.filter((function(t){return t.availability_id!=e})))};return Object(p.jsxs)("div",{className:"mt-3",children:[m&&Object(p.jsx)("div",{className:"alert alert-success",role:"alert",children:"Successfully added."}),d?Object(p.jsx)(U,{signalAddSuccess:function(){O(!0),y(v+1),setTimeout((function(){O(!1)}),2e3)},handleClose:function(){return b(!1)}}):Object(p.jsx)("div",{style:{textAlign:"center"},children:Object(p.jsx)("button",{type:"button",className:"btn btn-primary mb-5",onClick:function(){return b(!0)},children:"Add availability"})}),w?Object(p.jsx)("div",{className:"text-center",children:Object(p.jsx)("div",{className:"spinner-border",role:"status",style:{color:"orange"}})}):A&&Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:A}),s.map((function(e){return Object(p.jsx)(H,{removeAvailability:P,availability:e},e.availability_id)}))]})},R=n(29),Y=n.n(R),W=n(37);var $=function(e){var t=e.show,n=e.onClose,a=e.title,s=e.children;Object(c.useEffect)((function(){return document.addEventListener("keydown",i),function(){document.removeEventListener("keydown",i)}}),[]);var i=function(e){27===e.keyCode&&n()};return Object(p.jsx)("div",{className:"app-modal ".concat(t?"show":""),onClick:n,children:Object(p.jsxs)("div",{className:"app-modal-content",onClick:function(e){e.stopPropagation()},children:[Object(p.jsx)("div",{className:"modal-header",children:Object(p.jsx)("h4",{className:"app-modal-title",children:a})}),Object(p.jsx)("div",{className:"app-modal-body",children:s}),Object(p.jsx)("div",{className:"app-modal-footer",children:Object(p.jsx)("button",{className:"btn btn-secondary",onClick:n,children:"Close"})})]})})};var B=function(e){var t=e.id,n=e.onUpdate,a=Object(c.useState)(null),s=Object(r.a)(a,2),i=s[0],l=s[1],o=Object(c.useState)(!1),j=Object(r.a)(o,2),d=j[0],b=j[1],u=Object(c.useState)(""),h=Object(r.a)(u,2),m=h[0],O=h[1],x=Object(c.useState)(!1),g=Object(r.a)(x,2),v=g[0],y=g[1],N=Object(c.useState)(""),S=Object(r.a)(N,2),w=S[0],M=S[1],C=Object(c.useState)(!1),k=Object(r.a)(C,2),A=k[0],D=k[1],E=Object(c.useState)(""),P=Object(r.a)(E,2),T=(P[0],P[1]),_=Object(c.useRef)(!0);Object(c.useEffect)((function(){return function(){_.current=!1}}),[]),Object(c.useEffect)((function(){if(!t)return console.log("id is null"),void l(null);b(!0),O("");console.log("id is: ",t),fetch("".concat(f,"/api/appointment/id/").concat(t),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(!_.current)return null;if(!e.success)throw new Error(e.message);b(!1),O(""),console.log(e.appointment),l(e.appointment)})).catch((function(e){if(!_.current)return null;console.log(e),b(!1),O(e.message)}))}),[t]);var F=function(e){var t=Math.floor(e/60),n=t>=12?"PM":"AM",c=(e%60+"0").substring(0,2);return t="".concat((t+11)%12+1,":").concat(c," ").concat(n)};return Object(p.jsxs)("div",{className:"mb-2",children:[Object(p.jsxs)("div",{className:"appointment-info-upcoming-wrapper py-2 px-2",children:[d?Object(p.jsx)("div",{className:"text-center",children:Object(p.jsx)("div",{className:"spinner-border",role:"status"})}):m&&Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:m}),i&&Object(p.jsxs)("div",{children:[Object(p.jsx)("p",{style:{color:"black"},children:Object(p.jsxs)("b",{children:["Datetime: ",function(e,t){var n=e.getDate(),c=e.getMonth()+1,a=e.getFullYear(),s=F(60*Math.floor(e.getHours())+e.getMinutes()),i=F(60*Math.floor(e.getHours())+e.getMinutes()+t);return"".concat(n,"/").concat(c,"/").concat(a," ").concat(s," - ").concat(i)}(new Date(i.appointment_start),i.duration)," (",i.duration," minutes)"]})}),Object(p.jsxs)("p",{children:[Object(p.jsx)("b",{children:"Appointment ID: "}),i.appointment_id]}),Object(p.jsxs)("p",{children:[Object(p.jsx)("b",{children:"Lesson: "}),i.lesson_name]}),Object(p.jsxs)("p",{children:[Object(p.jsx)("b",{children:"Customer: "}),i.customer_name]}),Object(p.jsxs)("p",{children:[Object(p.jsx)("b",{children:"Email: "}),i.customer_email]}),Object(p.jsxs)("p",{children:[Object(p.jsx)("b",{children:"Phone: "}),i.customer_phone]}),Object(p.jsxs)("p",{children:[Object(p.jsx)("b",{children:"Note: "}),i.note]}),Object(p.jsxs)("p",{children:[Object(p.jsx)("b",{children:"Fee: "}),"$",i.fee]})]})]}),Object(p.jsx)("div",{className:"mt-2",children:v?A?Object(p.jsx)("button",{className:"btn btn-danger py-1 float-end",type:"button",disabled:!0,children:Object(p.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})}):Object(p.jsx)("div",{children:Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({id:i.appointment_id,message:w}),credentials:"include"};D(!0),T(""),fetch("".concat(f,"/api/appointment/admincancel?id=").concat(i.appointment_id,"}"),t).then((function(e){return e.json()})).then((function(e){if(!_.current)return null;if(!e.success)throw new Error(e.message);n()})).catch((function(e){console.log(e),D(!1),T(e.message)}))},className:"py-2",children:[Object(p.jsx)("textarea",{onChange:function(e){e.target.style.height="",e.target.style.height=Math.min(e.target.scrollHeight,300)+"px",M(e.target.value)},className:"form-control",id:"cancelText",rows:5,wrap:"soft",placeholder:"write message here"}),Object(p.jsx)("button",{type:"submit",title:"delete",className:"btn btn-danger my-2 float-end",children:Object(p.jsx)("span",{className:"align-middle button-text",style:{fontSize:12},children:"confirm cancellation"})})]})}):Object(p.jsx)("button",{className:"btn btn-danger float-end",onClick:function(){return y(!0)},children:"cancel appointment"})})]})};var V=function(){var e=Object(c.useState)(new Date),t=Object(r.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)([]),i=Object(r.a)(s,2),l=i[0],o=i[1],j=Object(c.useState)([]),d=Object(r.a)(j,2),b=d[0],u=d[1],h=Object(c.useState)(!1),m=Object(r.a)(h,2),O=m[0],x=m[1],g=Object(c.useState)(""),v=Object(r.a)(g,2),y=v[0],N=v[1],S=Object(c.useState)(""),w=Object(r.a)(S,2),M=w[0],C=w[1],k=Object(c.useState)(0),A=Object(r.a)(k,2),D=A[0],E=A[1],P=Object(c.useRef)(!0),T=["12:00 AM","12:30 AM","1:00 AM","1:30 AM","2:00 AM","2:30 AM","3:00 AM","3:30 AM","4:00 AM","4:30 AM","5:00 AM","5:30 AM","6:00 AM","6:30 AM","7:00 AM","7:30 AM","8:00 AM","8:30 AM","9:00 AM","9:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM","9:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM"];Object(c.useEffect)((function(){return function(){P.current=!1}}),[]),Object(c.useEffect)((function(){if(n){var e=[],t=new Date(n.setDate(n.getDate()-n.getDay()));t=new Date(t.getFullYear(),t.getMonth(),t.getDate());for(var c=0;c<7;c++){var a=new Date(t).setDate(t.getDate()+c);e.push(a)}o(e)}}),[n]),Object(c.useEffect)(Object(W.a)(Y.a.mark((function e(){var t,n,c,a,s,i,r,o,j,d,b;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.length){e.next=2;break}return e.abrupt("return");case 2:return N(""),x(!0),e.next=6,_().catch((function(e){N(e.message),x(!1),console.log(e)}));case 6:if(t=e.sent){e.next=10;break}return u([]),e.abrupt("return");case 10:for(n=t.length?t[0].minuteStart:0,c=1;c<t.length;c++)t[c].minuteStart<n&&(n=t[c].minuteStart);for(a=Math.floor(n/30),s=T.splice(a),i=new Array(s.length),r=0;r<i.length;r++)i[r]=new Array("","","","","","","","");for(o=0;o<i.length;o++)i[o][0]={type:"time",data:s[o]};j=new Date(l[0]),d=new Date(l[6]),b=d.setDate(d.getDate()+1),t.forEach((function(e){if(e.appointmentStart>=j&&e.appointmentStart<b){var t=e.appointmentStart.getDay()+1,c=Math.floor((e.minuteStart-n)/30);i[c][t]={type:"appointment",data:e};for(var a=Math.floor(e.duration/30)-1,s=0;s<a;s++)i[++c][t]={type:"spanned"}}})),x(!1),N(""),u(i);case 24:case"end":return e.stop()}}),e)}))),[l,D]);var _=function(){return new Promise((function(e,t){fetch("".concat(f,"/api/appointment/week?utcDate=").concat(n.toUTCString()),{credentials:"include"}).then((function(e){return e.json()})).then((function(t){if(!P)return null;if(!t.success)throw new Error(t.message);var n=t.appointments.map((function(e){return{appointmentId:e.appointment_id,customerName:e.customer_name,lessonName:e.lesson_name,appointmentStart:new Date(e.appointment_start),duration:e.duration,minuteStart:L(new Date(e.appointment_start))}}));e(n)})).catch((function(e){t(e)}))}))},F=function(){E(D+1)},L=function(e){return 60*e.getHours()+e.getMinutes()},I=function(e){var t=new Date(n);t.setDate(t.getDate()+7*e),a(t)},z=function(e){var t=Math.floor(e/60),n=t>=12?"PM":"AM",c=(e%60+"0").substring(0,2);return t="".concat((t+11)%12+1,":").concat(c," ").concat(n)},U=function(e,t){var n=z(60*Math.floor(e.getHours())+e.getMinutes()),c=z(60*Math.floor(e.getHours())+e.getMinutes()+t);return"".concat(n," - ").concat(c)},H=function(e){e.preventDefault(),C(e.currentTarget.id)};return Object(p.jsxs)("div",{children:[O?Object(p.jsx)("div",{className:"text-center",children:Object(p.jsx)("div",{className:"spinner-border",role:"status",style:{color:"orange"}})}):y&&Object(p.jsx)("div",{className:"alert alert-danger",role:"alert",children:y}),Object(p.jsxs)("div",{className:"mx-auto text-center",style:{overflowY:"auto",maxHeight:"100vh"},children:[Object(p.jsxs)("div",{className:"mw-1000 mx-auto my-3",children:[Object(p.jsx)("button",{className:"me-5",onClick:function(){return I(-1)},children:"previous"}),Object(p.jsx)("input",{type:"date",onChange:function(e){return a(new Date(e.target.value))}}),Object(p.jsx)("button",{onClick:function(){return F()},children:"refresh"}),Object(p.jsx)("button",{className:"ms-5",onClick:function(){return I(1)},children:"next"})]}),Object(p.jsx)("div",{className:"mw-1000 mx-auto",style:{overflowX:"scroll",maxHeight:"90vh"},children:Object(p.jsxs)("table",{className:"calendar",children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{style:{maxWidth:60}}),l.map((function(e,t){var n=function(e){var t=new Date(e),n=t.getDate(),c=t.getMonth(),a=t.getFullYear();return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()]+" "+n+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][c]+" "+a}(e).split(" "),c=Object(r.a)(n,4),a=c[0],s=c[1],i=c[2],l=c[3];return Object(p.jsxs)("th",{className:"head-fixed",children:[Object(p.jsx)("p",{children:a}),Object(p.jsxs)("p",{children:[s," ",i," ",l]})]},t)}))]})}),Object(p.jsxs)("tbody",{children:[Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{className:"header-fixed"}),Object(p.jsx)("td",{colSpan:7,style:{height:"20px"}})]}),b.map((function(e,t){return Object(p.jsx)("tr",{children:e.map((function(e,t){switch(e.type){case"appointment":var n=e.data;return Object(p.jsx)("td",{className:"td-with-data",rowSpan:Math.floor(n.duration/30),children:Object(p.jsxs)("div",{id:n.appointmentId,onClick:H,children:[Object(p.jsx)("p",{children:U(n.appointmentStart,n.duration)}),Object(p.jsx)("p",{children:n.lessonName}),Object(p.jsx)("p",{children:n.customerName}),Object(p.jsxs)("p",{children:[n.duration," minutes"]}),Object(p.jsx)("p",{children:n.appointmentId})]})},t);case"time":return Object(p.jsx)("th",{className:"header-fixed",style:{verticalAlign:"top"},children:Object(p.jsx)("div",{style:{minHeight:25},children:Object(p.jsx)("p",{className:"time",style:{position:"absolute",top:-12,right:5},children:e.data})})},t);case"spanned":return;default:return Object(p.jsx)("td",{},t)}}))},t)}))]})]})})]}),M&&Object(p.jsx)($,{show:!!M,onClose:function(){return C("")},title:"Appointment: ".concat(M),children:Object(p.jsx)(B,{id:M,onUpdate:function(){F(),C("")}})})]})};function G(){return Object(p.jsx)("div",{children:"Upload"})}var q=function(){return Object(p.jsx)("div",{children:Object(p.jsxs)("div",{style:{position:"relative"},children:[Object(p.jsx)(x,{}),Object(p.jsx)("div",{className:"content-wrapper",children:Object(p.jsxs)(o.c,{children:[Object(p.jsx)(o.a,{exact:!0,path:"/",children:"Greeting user"}),Object(p.jsx)(o.a,{path:"/calendar",children:Object(p.jsx)(V,{})}),Object(p.jsx)(o.a,{path:"/lesson",children:Object(p.jsx)(N,{})}),Object(p.jsx)(o.a,{path:"/availability",children:Object(p.jsx)(J,{})}),Object(p.jsx)(o.a,{path:"/upload",children:Object(p.jsx)(G,{})}),Object(p.jsx)(o.a,{path:"/booking",children:Object(p.jsx)(I,{})})]})})]})})};var X=function(){var e=Object(c.useContext)(O),t=(e.user,e.setUser),n=Object(c.useState)(""),a=Object(r.a)(n,2),s=a[0],i=a[1],l=Object(c.useState)(""),o=Object(r.a)(l,2),j=o[0],d=o[1],b=Object(c.useState)(!1),u=Object(r.a)(b,2),h=u[0],x=u[1],g=Object(c.useState)(""),v=Object(r.a)(g,2),y=v[0],N=v[1];return Object(c.useEffect)((function(){return document.body.style="background: #f29a04",function(){document.body.style={background:"#eee"}}}),[]),Object(p.jsx)("div",{children:Object(p.jsxs)("div",{className:"box",children:[Object(p.jsx)("h2",{children:"Login"}),Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:s,password:j}),credentials:"include"};x(!0),N(!1),fetch("".concat(f,"/api/auth/login"),n).then((function(e){return console.log(e),e})).then((function(e){return e.json()})).then((function(e){if(!e.success)throw new Error(e.message);m.a.set("loggedIn",!0),m.a.set("email",e.email),console.log(document.cookie),t({loggedIn:!0})})).catch((function(e){console.log(e),x(!1),N(e.message)}))},children:[Object(p.jsxs)("div",{className:"inputBox",children:[Object(p.jsx)("input",{type:"email",name:"email",onChange:function(e){return i(e.target.value)},required:!0}),Object(p.jsx)("label",{htmlFor:"email",children:"Username"})]}),Object(p.jsxs)("div",{className:"inputBox",children:[Object(p.jsx)("input",{type:"password",name:"password",onChange:function(e){return d(e.target.value)},required:!0}),Object(p.jsx)("label",{htmlFor:"password",children:"password"})]}),y&&Object(p.jsx)("div",{className:"alert alert-danger  show mt-3",role:"alert",children:y}),h?Object(p.jsxs)("button",{className:"btn btn-primary float-end",type:"button",disabled:!0,children:[Object(p.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),Object(p.jsx)("span",{className:"sr-only",children:"Loading..."})]}):Object(p.jsx)("button",{type:"submit",className:"btn btn-primary d-inline-block float-end",children:"Submit"})]})]})})};var K=function(){return Object(p.jsx)("div",{children:Object(p.jsx)(D.EatLoading,{size:"40"})})};var Q=function(){var e=Object(c.useState)(null),t=Object(r.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(!0),i=Object(r.a)(s,2),o=i[0],j=i[1];return Object(c.useEffect)((function(){m.a.get("loggedIn")&&a({loggedIn:!0}),j(!1)}),[]),Object(p.jsx)(O.Provider,{value:{user:n,setUser:a},children:Object(p.jsx)("div",{children:Object(p.jsx)(l.a,{basename:"admin",children:o?Object(p.jsx)(K,{}):n?Object(p.jsx)(q,{}):Object(p.jsx)(X,{})})})})};i.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(Q,{})}),document.getElementById("root"))}},[[93,1,2]]]);
//# sourceMappingURL=main.db3b5d97.chunk.js.map